(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    311130,       8857]
NotebookOptionsPosition[    298728,       8472]
NotebookOutlinePosition[    299065,       8487]
CellTagsIndexPosition[    299022,       8484]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721207001208928*^9, 3.721207004448391*^9}}],

Cell[CellGroupData[{

Cell["Colour simplifier", "Subsection",
 CellChangeTimes->{{3.721559647160177*^9, 3.7215596517729387`*^9}, {
  3.7215619878559437`*^9, 3.721562004911821*^9}}],

Cell[TextData[{
 "The aim of this section is to design a function that is capable of \
simplifiying the colour charges of 2 partons i and j into a part proportional \
to  C_A and part that depends ONLY on ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "^2, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "i"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "^2 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "i"], "\[CenterDot]", 
    SubscriptBox["T", "j"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.721559670209054*^9, 3.721559806624734*^9}, {
  3.721568547251731*^9, 3.7215685576917*^9}}],

Cell[CellGroupData[{

Cell["Commnads to symplify expression in colour space", "Subsubsection",
 CellChangeTimes->{{3.721207034001466*^9, 3.721207045833743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sc", "=", "1"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColourSimplify", "[", "intlist_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"templist", ",", "sc"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"templist", "=", "intlist"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"TQTQ", "[", "templist", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"ChargesCommute", "[", "templist", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"ChargesDontCommute", "[", "templist", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"TQTITI", "[", "templist", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"TQTQ", "[", "templist", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"IdentifyCasimir", "[", "templist", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"templist", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_", ",", "x3___"}], "}"}], "/;", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2"}], "}"}], ",", 
             RowBox[{"T", "[", "__", "]"}]}], "]"}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2"}], "}"}], ",", 
             RowBox[{"Tq", "[", "__", "]"}]}], "]"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", "x1", "]"}], "=!=", "List"}]}]}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", " ", "x2"}], ",", "x3"}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", "templist", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.7183824529144773`*^9, 3.718382486787115*^9}, {
   3.718382693910887*^9, 3.7183826958459053`*^9}, {3.718382744616041*^9, 
   3.7183828048754053`*^9}, {3.7183828402450037`*^9, 3.718382975340418*^9}, {
   3.718383920775284*^9, 3.71838397651162*^9}, {3.7210542421423693`*^9, 
   3.721054284955639*^9}, {3.7210543191990557`*^9, 3.721054396332965*^9}, {
   3.721054432025984*^9, 3.721054438296502*^9}, {3.721054511879019*^9, 
   3.7210545138704967`*^9}, {3.7210545639413033`*^9, 
   3.7210549011324797`*^9}, {3.7210550078268423`*^9, 3.721055096617505*^9}, {
   3.721055157941897*^9, 3.721055161740211*^9}, {3.721055244485375*^9, 
   3.721055326720916*^9}, {3.72105559675134*^9, 3.721055828101864*^9}, {
   3.721055885769004*^9, 3.72105591327602*^9}, {3.721056015312437*^9, 
   3.721056040928556*^9}, {3.721056142806692*^9, 3.7210561879905453`*^9}, {
   3.7210562203413897`*^9, 3.72105623156004*^9}, {3.721056266903687*^9, 
   3.721056271847131*^9}, {3.721056331063549*^9, 3.721056390803081*^9}, {
   3.721056453572792*^9, 3.721056629603806*^9}, {3.721056693666946*^9, 
   3.721056882068605*^9}, {3.7210572165504704`*^9, 3.721057235093313*^9}, {
   3.721057280572727*^9, 3.7210573423287086`*^9}, {3.7210575524696503`*^9, 
   3.721057665319439*^9}, {3.721057747899693*^9, 3.721057854958888*^9}, {
   3.721057916678936*^9, 3.721057956448941*^9}, {3.721058496197723*^9, 
   3.721058507445352*^9}, {3.721058641803555*^9, 3.7210586772606907`*^9}, {
   3.721058792935341*^9, 3.721058793038268*^9}, {3.7210589074195843`*^9, 
   3.721058912196322*^9}, {3.721059031770492*^9, 3.721059041704352*^9}, {
   3.721059095407475*^9, 3.721059097128213*^9}, {3.721059258979808*^9, 
   3.721059359450182*^9}, {3.721059822346632*^9, 3.721059822994361*^9}, {
   3.72106154745302*^9, 3.7210616018423243`*^9}, {3.721061723463213*^9, 
   3.721061725190606*^9}, {3.721061832492638*^9, 3.721061833683372*^9}, 
   3.721062005145836*^9, {3.721062046610635*^9, 3.7210620600990057`*^9}, {
   3.721062117460382*^9, 3.7210621410945807`*^9}, {3.721062226507606*^9, 
   3.721062244842043*^9}, {3.72106229770092*^9, 3.721062503932399*^9}, {
   3.72106258716083*^9, 3.721062633443839*^9}, {3.721062668325285*^9, 
   3.721062745712161*^9}, {3.7210627872661448`*^9, 3.721062886461789*^9}, {
   3.721062927086935*^9, 3.721062932071121*^9}, {3.721062985810603*^9, 
   3.721063030604753*^9}, {3.721063126234605*^9, 3.721063131795042*^9}, {
   3.721063210013529*^9, 3.7210632400806913`*^9}, {3.721063270610135*^9, 
   3.72106327091308*^9}, {3.721063316724463*^9, 3.721063447943173*^9}, {
   3.7210635307913713`*^9, 3.7210635484699993`*^9}, {3.721063585377634*^9, 
   3.721063596825316*^9}, {3.721063635522812*^9, 3.721063674485091*^9}, {
   3.721063837485208*^9, 3.721063934774674*^9}, 3.7210639947303877`*^9, {
   3.721064096189608*^9, 3.7210640980934*^9}, {3.721064129519932*^9, 
   3.721064288429188*^9}, {3.721064367699794*^9, 3.721064392892208*^9}, {
   3.721064427125004*^9, 3.721064427782596*^9}, {3.721064463968726*^9, 
   3.7210644875680304`*^9}, {3.721064528782968*^9, 3.721064541545959*^9}, {
   3.7210645896489153`*^9, 3.7210646340885344`*^9}, 3.7210673112758713`*^9, {
   3.721067369418726*^9, 3.721067464036697*^9}, {3.721067502832498*^9, 
   3.721067544472884*^9}, {3.721067591599135*^9, 3.721067600423386*^9}, {
   3.721067650936165*^9, 3.721067656086431*^9}, 3.72106774547606*^9, {
   3.7210678209421873`*^9, 3.721067823941244*^9}, 3.721068126135919*^9, 
   3.72120698799657*^9, {3.72120702756316*^9, 3.72120702851385*^9}, {
   3.721311192215412*^9, 3.7213112421226797`*^9}, {3.721311467271343*^9, 
   3.7213114696862173`*^9}, 3.721312168884439*^9, {3.721312570520321*^9, 
   3.721312589209037*^9}, {3.7213136183177233`*^9, 3.72131364910155*^9}, {
   3.721320176209861*^9, 3.721320196619543*^9}, 3.721363205019052*^9, {
   3.721363369566712*^9, 3.721363370093882*^9}, {3.721363746758366*^9, 
   3.721363748590716*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TQTQ", "[", "intlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "templist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"templist", "=", "intlist"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", "a__", "]"}], ",", "x3__", ",", 
             RowBox[{"Tq", "[", "b__", "]"}], ",", "x2___"}], "}"}], "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "x3", "}"}], ",", "Tq"}], "]"}]}], " ", 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"Tq", "[", "a", "]"}], ",", 
            RowBox[{"Tq", "[", "b", "]"}], ",", "x3", ",", "x2"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"a__", ",", "c_"}], "]"}], ",", 
             RowBox[{"Tq", "[", "e__", "]"}], ",", "x2___"}], "}"}], "/;", 
           " ", 
           RowBox[{"FreeQ", "[", 
            RowBox[{
             RowBox[{"{", "e", "}"}], ",", "c"}], "]"}]}], " ", 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"c", ",", "a"}], "]"}], ",", 
            RowBox[{"Tq", "[", "e", "]"}], ",", "x2"}], "}"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"e_", ",", "d_", ",", "f_"}], "]"}], ",", "x2___"}], 
            "}"}], "/;", " ", 
           RowBox[{"c", "===", "d"}]}], " ", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "x1", ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"d", ",", "e", ",", "f"}], "]"}], ",", "x2"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"e_", ",", "d_", ",", "f_"}], "]"}], ",", "x2___"}], 
            "}"}], "/;", " ", 
           RowBox[{"c", "===", "f"}]}], " ", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "x1", ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"f", ",", "d", ",", "e"}], "]"}], ",", "x2"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"c_", ",", "d_", ",", "f_"}], "]"}], ",", "x2___"}], 
            "}"}], "/;", " ", 
           RowBox[{"b", "===", "f"}]}], " ", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "x1", ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"c", ",", "f", ",", "d"}], "]"}], ",", "x2"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"c_", ",", "d_", ",", "f_"}], "]"}], ",", "x2___"}], 
            "}"}], "/;", " ", 
           RowBox[{"a", "===", "d"}]}], " ", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "x1", ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"b", ",", "a", ",", "c"}], "]"}], ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"c", ",", "d", ",", "f"}], "]"}], ",", "x2"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1___", ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ",", 
            RowBox[{"Tq", "[", 
             RowBox[{"c_", ",", "b_", ",", "f_"}], "]"}], ",", "x2___"}], 
           "}"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"CA", ",", "x1", ",", "x2"}], "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{"a", "->", "f"}], "}"}]}], ")"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", " ", "[", "templist", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TQTITI", "[", "intlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "templist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"templist", "=", "intlist"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"Tq", "[", "a__", "]"}], ",", "x2___", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "b_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", "x3___"}], "}"}], "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "b"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "c"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{"b", "=!=", "c"}]}]}], ":>", 
          RowBox[{"TQTQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "x1", ",", 
             RowBox[{"Tq", "[", "a", "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"b", ",", "c", ",", 
               RowBox[{"rc", "[", 
                RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", "x2", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", 
               RowBox[{"rc", "[", "sc", "]"}]}], "]"}], " ", ",", "x3"}], 
            "}"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "b_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", "x2___", ",", 
             RowBox[{"Tq", "[", "a__", "]"}], ",", "x3___"}], "}"}], "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "b"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "c"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{"b", "=!=", "c"}]}]}], ":>", 
          RowBox[{"TQTQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "x1", ",", 
             RowBox[{"Tq", "[", "a", "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"b", ",", "c", ",", 
               RowBox[{"rc", "[", 
                RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", 
               RowBox[{"rc", "[", "sc", "]"}]}], "]"}], ",", "x2", " ", ",", 
             "x3"}], "}"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "b_"}], "]"}], ",", 
             RowBox[{"Tq", "[", "a__", "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", "x2___"}], "}"}], "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "b"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "c"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{"b", "=!=", "c"}]}]}], ":>", 
          RowBox[{"TQTQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", "x1", ",", 
             RowBox[{"Tq", "[", "a", "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"b", ",", "c", ",", 
               RowBox[{"rc", "[", 
                RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", 
               RowBox[{"rc", "[", "sc", "]"}]}], "]"}], ",", "x2"}], " ", 
            "}"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "b_"}], "]"}], ",", "x1___", ",", 
             RowBox[{"Tq", "[", "a__", "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", "x2___"}], "}"}], "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "b"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "c"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&&", 
            RowBox[{"b", "=!=", "c"}]}]}], ":>", 
          RowBox[{"TQTQ", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "/", "2"}], ",", 
             RowBox[{"Tq", "[", "a", "]"}], ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"b", ",", "c", ",", 
               RowBox[{"rc", "[", 
                RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", "x1", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", 
               RowBox[{"rc", "[", "sc", "]"}]}], "]"}], ",", "x2"}], " ", 
            "}"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"IdentifyCasimir", "[", "templist", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", " ", "[", "templist", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IdentifyCasimir", "[", "intlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "templist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"templist", "=", "intlist"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", "x2___"}], "}"}], "/;", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "=!=", "0"}]}], 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["C", "i"], ",", "x1", ",", "x2"}], "}"}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", " ", "[", "templist", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChargesCommute", "[", "intlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "templist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"templist", "=", "intlist"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1___", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", "x2___", ",", 
             RowBox[{"T", "[", 
              RowBox[{"k_", ",", "a_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "b_"}], "]"}], ",", "x3___"}], "}"}], "/;", 
           RowBox[{"k", "=!=", "i"}]}], ":>", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"T", "[", 
             RowBox[{"i", ",", "c"}], "]"}], ",", "x2", ",", 
            RowBox[{"T", "[", 
             RowBox[{"i", ",", "b"}], "]"}], ",", 
            RowBox[{"T", "[", 
             RowBox[{"k", ",", "a"}], "]"}], ",", "x3"}], "}"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"templist", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"k_", ",", "c_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"k_", ",", "a_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "c_"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i_", ",", "a_"}], "]"}]}], "}"}], "/;", 
           RowBox[{"k", "=!=", "i"}]}], ":>", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"k", ",", "c"}], "]"}], ",", 
            RowBox[{"T", "[", 
             RowBox[{"i", ",", "c"}], "]"}], ",", 
            RowBox[{"T", "[", 
             RowBox[{"k", ",", "a"}], "]"}], ",", 
            RowBox[{"T", "[", 
             RowBox[{"i", ",", "a"}], "]"}]}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"IdentifyCasimir", "[", "templist", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", " ", "[", "templist", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChargesDontCommute", "[", "intlist_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "templist", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"templist", "=", "intlist"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"templist", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1___", ",", 
           RowBox[{"T", "[", 
            RowBox[{"i_", ",", "c_"}], "]"}], ",", 
           RowBox[{"T", "[", 
            RowBox[{"i_", ",", "a_"}], "]"}], ",", 
           RowBox[{"T", "[", 
            RowBox[{"i_", ",", "c_"}], "]"}], ",", "x2___"}], "}"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", "c"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", "c"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", "a"}], "]"}], ",", "x2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"c", ",", "a", ",", 
               RowBox[{"rc", "[", 
                RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", 
               RowBox[{"rc", "[", "sc", "]"}]}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", "c"}], "]"}], ",", "x2"}], "}"}]}], "}"}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"templist", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1___", ",", 
            RowBox[{"T", "[", 
             RowBox[{"k_", ",", "c_"}], "]"}], ",", "x2___", ",", 
            RowBox[{"T", "[", 
             RowBox[{"i_", ",", "a_"}], "]"}], ",", 
            RowBox[{"T", "[", 
             RowBox[{"i_", ",", "c_"}], "]"}], ",", "x3___"}], "}"}], "/;", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"x2", ",", 
            RowBox[{"T", "[", 
             RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"T", "[", 
              RowBox[{"k", ",", "c"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", "c"}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", "a"}], "]"}], ",", "x2", ",", "x3"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"Tq", "[", 
              RowBox[{"a", ",", "c", ",", 
               RowBox[{"rc", "[", 
                RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", 
             RowBox[{"T", "[", 
              RowBox[{"k", ",", "c"}], "]"}], ",", "x2", " ", ",", 
             RowBox[{"T", "[", 
              RowBox[{"i", ",", 
               RowBox[{"rc", "[", "sc", "]"}]}], "]"}], ",", "x3"}], "}"}]}], 
          "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"IdentifyCasimir", "[", "templist", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", "templist", "]"}]}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.721062081794552*^9, 3.721062114067762*^9}, {
   3.721062154454691*^9, 3.7210621686713543`*^9}, {3.721062444145112*^9, 
   3.721062445522656*^9}, {3.721062514661602*^9, 3.721062515988565*^9}, {
   3.721062563798917*^9, 3.721062578536253*^9}, 3.72106371366614*^9, {
   3.721064436507731*^9, 3.721064469518001*^9}, {3.721064520876326*^9, 
   3.721064521483575*^9}, {3.7210645619664383`*^9, 3.72106459291971*^9}, {
   3.721064665734948*^9, 3.721064694172812*^9}, {3.721064790623377*^9, 
   3.721064806384984*^9}, {3.721067320145318*^9, 3.72106733787468*^9}, 
   3.721067400411861*^9, {3.721067479027481*^9, 3.721067514626257*^9}, {
   3.721067608541751*^9, 3.721067642319729*^9}, {3.721067759275506*^9, 
   3.72106777780846*^9}, {3.7210680689363823`*^9, 3.721068069662644*^9}, {
   3.721206992484014*^9, 3.721206994852138*^9}, 3.721207063905863*^9, 
   3.7212074011922903`*^9, 3.721207553384035*^9, 3.7212078246329603`*^9, 
   3.721311396105441*^9, {3.721311490178439*^9, 3.721311494234377*^9}, {
   3.721311532423399*^9, 3.721311566922967*^9}, 3.72131165722536*^9, {
   3.721311870323209*^9, 3.721311898786161*^9}, {3.7213119394915857`*^9, 
   3.721311939520789*^9}, {3.72131201721634*^9, 3.721312032004475*^9}, 
   3.7213121600403*^9, {3.721312237412916*^9, 3.7213122538212833`*^9}, 
   3.721312291044121*^9, {3.721312354065937*^9, 3.721312377876718*^9}, {
   3.721312410481427*^9, 3.721312439667021*^9}, {3.721312531497944*^9, 
   3.721312532913878*^9}, 3.721312601907847*^9, 3.721312641941828*^9, 
   3.721312826818967*^9, {3.7213131914189672`*^9, 3.721313199178686*^9}, {
   3.7213133183234673`*^9, 3.721313320739038*^9}, {3.721313654232903*^9, 
   3.7213137826730824`*^9}, {3.721313822742714*^9, 3.7213138432062883`*^9}, {
   3.721320142348366*^9, 3.7213201692860947`*^9}, 3.721362713569221*^9, {
   3.7213627469872713`*^9, 3.721362795887192*^9}, {3.721363088327305*^9, 
   3.721363088709157*^9}, 3.721363123098399*^9, {3.721363516831756*^9, 
   3.7213635505595007`*^9}, {3.721364115004306*^9, 3.721364125100747*^9}, 
   3.721364405256854*^9, {3.721380368568605*^9, 3.721380377286394*^9}, {
   3.721381145707883*^9, 3.721381168546073*^9}, {3.7213815979861794`*^9, 
   3.721381620066071*^9}, 3.721381677351351*^9, {3.7213817858013678`*^9, 
   3.721381789833605*^9}, {3.7213819116937513`*^9, 3.721381911956829*^9}, 
   3.721382157674488*^9, {3.721382205801528*^9, 3.721382342514378*^9}, {
   3.721382377327385*^9, 3.721382377715733*^9}, {3.7213824477867327`*^9, 
   3.721382447834182*^9}, {3.7213824883547077`*^9, 3.721382557761574*^9}, {
   3.7213834571017036`*^9, 3.721383482878971*^9}, {3.7214482885434637`*^9, 
   3.721448299087111*^9}, {3.721448822857402*^9, 3.721448825639798*^9}, 
   3.721450675108779*^9, {3.721450736616625*^9, 3.721450741372816*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.72155985807866*^9, 3.7215598601101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadableNotation", "[", "inlist_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "templist", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"templist", "=", " ", 
      RowBox[{"inlist", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1___", ",", 
           RowBox[{"T", "[", 
            RowBox[{"i_", ",", "r_"}], "]"}], " ", ",", 
           RowBox[{"T", "[", 
            RowBox[{"k_", ",", "r_"}], "]"}], ",", "x2___"}], "}"}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"CenterDot", "[", 
            RowBox[{
             SubscriptBox["T", "i"], ",", 
             SubscriptBox["T", "k"]}], "]"}], ",", "x2"}], "}"}]}], "}"}]}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"templist", "=", " ", 
      RowBox[{"templist", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1_", ",", "x2_"}], "}"}], "/;", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "x1", "]"}], "=!=", "List"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", "x1", "]"}], "=!=", "List"}]}]}], 
         "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"x1", " ", "x2"}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"templist", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Plus", "@@", "templist"}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"Flatten", "[", "templist", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "templist", "]"}], ";"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ColourSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i", ",", "a"}], "]"}], ",", 
     RowBox[{"Tq", "[", 
      RowBox[{"a", ",", "c", ",", "b"}], "]"}], ",", 
     RowBox[{"Tq", "[", 
      RowBox[{"b", ",", "c", ",", "d"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"j", ",", "d"}], "]"}]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7212169204859858`*^9, 3.721216961778179*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"CA", ",", 
    RowBox[{"T", "(", 
     RowBox[{"i", ",", "d"}], ")"}], ",", 
    RowBox[{"T", "(", 
     RowBox[{"j", ",", "d"}], ")"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.7212169498297586`*^9, 3.721216962120757*^9}, 
   3.721306320790145*^9, {3.7213125230762987`*^9, 3.721312539851109*^9}, 
   3.721313376491353*^9, 3.721313416608066*^9, 3.7213137949716597`*^9, 
   3.7213200892382517`*^9, {3.721320183300714*^9, 3.7213201994547243`*^9}, 
   3.721358427736807*^9, 3.7213626643673973`*^9, 3.72136303901086*^9, 
   3.7213631282556257`*^9, {3.721363372985875*^9, 3.721363391630721*^9}, 
   3.72136355355099*^9, 3.721364053871386*^9, 3.7213644142674217`*^9, 
   3.721380383039956*^9, 3.7213815684660807`*^9, 3.721381681021203*^9, 
   3.721382886380536*^9, 3.72138348847656*^9, 3.721412833094688*^9, 
   3.721446598114441*^9, 3.721448857709103*^9, 3.721450682257131*^9, 
   3.721453854908885*^9, 3.721461617343594*^9, 3.721559871610936*^9, 
   3.721565352012712*^9, 3.721566449967517*^9, 3.7215673443654833`*^9, 
   3.721631572953958*^9, 3.7216376551486797`*^9, 3.721639427171988*^9, 
   3.721644952119459*^9, 3.721645085922035*^9, 3.721671503647925*^9, 
   3.7216719811040382`*^9, 3.7216768489129133`*^9, 3.721724870139077*^9, 
   3.722060175124456*^9, 3.722064799525653*^9, 3.7220717885592213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ColourSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Tq", "[", 
       RowBox[{"a", ",", "c", ",", "b"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "a"}], "]"}], ",", " ", 
      RowBox[{"T", "[", 
       RowBox[{"j", ",", "b"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "c"}], "]"}]}], "}"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColourSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "b"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "a"}], "]"}], ",", " ", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "b"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "a"}], "]"}]}], "}"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColourSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "a"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", "b"}], "]"}], ",", " ", 
      RowBox[{"Tq", "[", 
       RowBox[{"a", ",", "c", ",", "b"}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"j", ",", "c"}], "]"}]}], "}"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColourSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i", ",", "a"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"j", ",", "b"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"j", ",", "b"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"j", ",", "a"}], "]"}]}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReadableNotation", "[", "%", "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.718382815046361*^9, 3.718382828532309*^9}, {
  3.718383990176074*^9, 3.7183839967759943`*^9}, {3.718384711930682*^9, 
  3.71838471384087*^9}, {3.721054652442299*^9, 3.721054655688936*^9}, {
  3.721054690410391*^9, 3.7210546904505377`*^9}, {3.721055201629388*^9, 
  3.721055204883917*^9}, {3.721056302597691*^9, 3.7210563050925198`*^9}, {
  3.721207584277644*^9, 3.7212075923096867`*^9}, {3.721207716151787*^9, 
  3.721207761086398*^9}, {3.721320248220626*^9, 3.7213202679398212`*^9}, {
  3.721358362328339*^9, 3.721358415859008*^9}, {3.721363801864746*^9, 
  3.721363805544693*^9}, {3.721382896064117*^9, 3.7213828962881203`*^9}, {
  3.7215598208941917`*^9, 3.7215598298134108`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["C", "j"], " ", 
    RowBox[{
     SubscriptBox["T", "i"], "\[CenterDot]", 
     SubscriptBox["T", "j"]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.721207593026799*^9, 3.721207625139027*^9}, 
   3.721207692699688*^9, 3.721207761402607*^9, {3.721207826577269*^9, 
   3.721207829863006*^9}, 3.7213063208448753`*^9, 3.721310944001197*^9, {
   3.721312523117592*^9, 3.721312539891837*^9}, 3.721313186059952*^9, 
   3.721313376529914*^9, 3.7213134166339912`*^9, 3.7213137950768223`*^9, 
   3.721320084100204*^9, {3.721320165022498*^9, 3.7213202095113163`*^9}, {
   3.721320259258264*^9, 3.721320268377387*^9}, 3.721320330684389*^9, {
   3.72135841640626*^9, 3.721358435983736*^9}, {3.721362664391677*^9, 
   3.7213626929964247`*^9}, 3.721362828122561*^9, 3.721363039045494*^9, 
   3.721363128286872*^9, {3.72136337302355*^9, 3.721363391671205*^9}, 
   3.7213635535861263`*^9, {3.7213638030247593`*^9, 3.721363806159042*^9}, {
   3.721363904223954*^9, 3.721363921034281*^9}, 3.7213639538219137`*^9, {
   3.72136400293003*^9, 3.721364004283901*^9}, {3.721364043181699*^9, 
   3.721364046420334*^9}, {3.7213640809171553`*^9, 3.7213640884256363`*^9}, 
   3.7213642475818567`*^9, 3.721364414334584*^9, 3.721380383064988*^9, 
   3.721380683099839*^9, 3.7213815685113487`*^9, 3.7213816810577717`*^9, 
   3.72138212964839*^9, {3.7213821610190983`*^9, 3.721382178118986*^9}, {
   3.721382886431097*^9, 3.721382904029971*^9}, {3.7213830636020317`*^9, 
   3.721383074480669*^9}, 3.721383488527416*^9, 3.721412833139997*^9, 
   3.721446598151848*^9, 3.721448857773274*^9, 3.7214506823179502`*^9, 
   3.721453854938634*^9, 3.721461617376214*^9, 3.721559871660564*^9, 
   3.721565352083956*^9, 3.7215664500252857`*^9, 3.72156734445739*^9, 
   3.72163157300695*^9, 3.721637655179339*^9, 3.721639427204796*^9, 
   3.7216449521768217`*^9, 3.7216450859537888`*^9, 3.7216715037010393`*^9, 
   3.7216719811601067`*^9, 3.721676849110902*^9, 3.721724870243577*^9, 
   3.7220601752776537`*^9, 3.722064799549719*^9, 3.72207178858477*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721207869728938*^9, 3.721208022500628*^9}, {
   3.721208260828369*^9, 3.721208272523376*^9}, {3.721208318868895*^9, 
   3.7212084665626*^9}, {3.72130712991628*^9, 3.721307143484809*^9}, {
   3.721313217001409*^9, 3.721313305984024*^9}, {3.721320103442169*^9, 
   3.72132013689655*^9}, {3.721320321229494*^9, 3.721320328261442*^9}, {
   3.721363824798698*^9, 3.721363897513842*^9}, {3.721364077041275*^9, 
   3.721364078638571*^9}, {3.7213643004360943`*^9, 3.72136430420326*^9}, {
   3.721364356807604*^9, 3.721364367538582*^9}, {3.721364432073724*^9, 
   3.7213644337672853`*^9}, {3.721380802685508*^9, 3.721380813252696*^9}, {
   3.721382173017849*^9, 3.7213821742534103`*^9}, {3.721383050104575*^9, 
   3.721383071783033*^9}, 3.721559838855422*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReadableNotation", "[", "\[IndentingNewLine]", 
  RowBox[{"ColourSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Tq", "[", 
      RowBox[{"a", ",", "c", ",", "b"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"i", ",", "a"}], "]"}], ",", " ", 
     RowBox[{"T", "[", 
      RowBox[{"j", ",", "b"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"i", ",", "c"}], "]"}]}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.721208428439701*^9, 3.721208441138647*^9}, 
   3.721208489764821*^9, {3.7212085359727697`*^9, 3.7212085532706747`*^9}, 
   3.7213071476445637`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "CA", " ", 
    RowBox[{
     SubscriptBox["T", "i"], "\[CenterDot]", 
     SubscriptBox["T", "j"]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.721208459447382*^9, 3.721208490983086*^9}, {
   3.721208539823722*^9, 3.721208553830886*^9}, 3.721306320989715*^9, 
   3.721307147904941*^9, {3.721312523212345*^9, 3.721312539987371*^9}, 
   3.721313272024197*^9, 3.721313376625211*^9, 3.721313416724977*^9, 
   3.7213137954512978`*^9, 3.721320092941526*^9, {3.721320183548387*^9, 
   3.7213201995449266`*^9}, 3.721358427868124*^9, 3.721362664457849*^9, 
   3.721363039129487*^9, 3.721363128338896*^9, {3.7213633730795383`*^9, 
   3.721363391719797*^9}, 3.7213635536537113`*^9, 3.721364414487917*^9, 
   3.7213803831974373`*^9, 3.721381568568317*^9, 3.721381681110317*^9, 
   3.7213828864866333`*^9, 3.721383488591748*^9, 3.721412833233932*^9, 
   3.721446598269105*^9, 3.721448857869946*^9, 3.721450682445717*^9, 
   3.721453855029814*^9, 3.721461617477223*^9, 3.72155987174226*^9, 
   3.7215653521622562`*^9, 3.721566450103611*^9, 3.721567344535533*^9, 
   3.7216315730694523`*^9, 3.721637655249898*^9, 3.7216394272883472`*^9, 
   3.721644952256535*^9, 3.7216450860237703`*^9, 3.72167150377944*^9, 
   3.721671981236974*^9, 3.721676849264941*^9, 3.721724870300941*^9, 
   3.7220601753502197`*^9, 3.722064799572386*^9, 3.722071788690488*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Definitions Catani Grazini Czakon Heymes", "Subsection",
 CellChangeTimes->{{3.721453893743841*^9, 3.72145390399044*^9}}],

Cell["\<\
We take the defintions from Catani + Grazzini (CG) and Czakon + Heymes (CH) \
from Appendix D in arXiv:1408.2500.\
\>", "Text",
 CellChangeTimes->{{3.721560246194079*^9, 3.7215602945489693`*^9}, {
  3.721560432394309*^9, 3.721560444881545*^9}, {3.721560516819901*^9, 
  3.721560527603588*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"sp", ",", "Orderless"}], "]"}]], "Input",
 CellChangeTimes->{{3.721411199806141*^9, 3.7214112094110727`*^9}}],

Cell["Eq. D.42", "Text",
 CellChangeTimes->{{3.721560213160376*^9, 3.721560241664234*^9}, {
  3.721560437130031*^9, 3.721560437729439*^9}, {3.7215605108279667`*^9, 
  3.721560535780292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SCG", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"d", "-", "2"}], 
     RowBox[{"2", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], "]"}], "^", "2"}]}]], 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], "]"}], 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], "]"}], 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], "]"}]}]}], 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}]}]]}], "-", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "j"]}], "]"}], ")"}], "2"], 
     RowBox[{"2", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "2"]}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{"2", "-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           SubscriptBox["q", "1"]}], "]"}], 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           SubscriptBox["q", "2"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           SubscriptBox["q", "2"]}], "]"}], 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           SubscriptBox["q", "1"]}], "]"}]}]}], 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], "]"}]}]]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], "]"}], 
     RowBox[{"2", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["2", 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}]], "+", 
      FractionBox["2", 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "1"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{"4", "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"sp", "[", 
               RowBox[{
                SubscriptBox["p", "i"], ",", 
                SubscriptBox["q", "1"]}], "]"}], 
              RowBox[{"sp", "[", 
               RowBox[{
                SubscriptBox["p", "j"], ",", 
                SubscriptBox["q", "2"]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"sp", "[", 
               RowBox[{
                SubscriptBox["p", "i"], ",", 
                SubscriptBox["q", "2"]}], "]"}], 
              RowBox[{"sp", "[", 
               RowBox[{
                SubscriptBox["p", "j"], ",", 
                SubscriptBox["q", "1"]}], "]"}]}]}], ")"}], "2"], 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             SubscriptBox["q", "1"]}], "]"}], 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             SubscriptBox["q", "2"]}], "]"}], 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             SubscriptBox["q", "1"]}], "]"}], 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             SubscriptBox["q", "2"]}], "]"}]}]]}], ")"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.721410717138954*^9, 3.721410821538919*^9}, {
   3.721410855608282*^9, 3.721411193644001*^9}, {3.721411445091683*^9, 
   3.721411451346987*^9}, {3.7214117568294573`*^9, 3.721411766484261*^9}, 
   3.7214499190494947`*^9, 3.72145032515901*^9, {3.7214505718763*^9, 
   3.7214505735319*^9}, {3.7214654947674713`*^9, 3.7214654982246933`*^9}, {
   3.721465552898328*^9, 3.721465553146009*^9}, {3.721559911500443*^9, 
   3.721559919654251*^9}, {3.721559957798232*^9, 3.721559960965433*^9}}],

Cell["Eq. D43", "Text",
 CellChangeTimes->{{3.721560546444522*^9, 3.721560548908084*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SCH", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"4", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], "]"}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], "]"}]}], 
    RowBox[{"2", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], "]"}]}]], "-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           SubscriptBox["q", "1"]}], "]"}], ")"}], "2"], 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}]], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           SubscriptBox["q", "2"]}], "]"}], ")"}], "2"], 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "2"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "1"]}], "]"}]}]]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.721411400657488*^9, 3.7214114421694317`*^9}, {
   3.721411503140708*^9, 3.721411677527775*^9}, {3.721411710837028*^9, 
   3.7214117422426*^9}, {3.721411779117322*^9, 3.721411871398808*^9}, 
   3.721560082361816*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SCH", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"CH", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "\[Rule]", 
       SubscriptBox["q", "2"]}], ",", 
      RowBox[{
       SubscriptBox["q", "2"], "\[Rule]", 
       SubscriptBox["q", "1"]}]}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.721411877991219*^9, 3.7214119143042383`*^9}, 
   3.721560084089589*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"CH", "(", 
     RowBox[{"i", ",", "j"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], "2"], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}]], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}], "2"], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}]}]]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.7214119147407722`*^9, 3.721412340126686*^9, 
  3.7214145534156322`*^9, 3.721450332826429*^9, 3.7214507843890867`*^9, 
  3.721452262836773*^9, 3.7214539212904367`*^9, 3.721461617766829*^9, 
  3.72146555733249*^9, 3.721565352312277*^9, 3.721566450232892*^9, 
  3.721567344685821*^9, 3.72163157317089*^9, 3.721637655366531*^9, 
  3.721639427374628*^9, 3.721644952342757*^9, 3.721645086098485*^9, 
  3.721671503895383*^9, 3.72167198135156*^9, 3.721676849438931*^9, 
  3.721724870410737*^9, 3.722060175410042*^9, 3.7220647996263247`*^9, 
  3.72207178884198*^9}]
}, Open  ]],

Cell["Eq. D.41", "Text",
 CellChangeTimes->{{3.721560593605536*^9, 3.721560613269589*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SPartial", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"SCG", "[", 
    RowBox[{"i", ",", "j"}], "]"}], "+", 
   RowBox[{
    RowBox[{"sp", "[", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "i"]}], "]"}], 
    RowBox[{"SCH", "[", 
     RowBox[{"i", ",", "j"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"sp", "[", 
     RowBox[{
      SubscriptBox["p", "j"], ",", 
      SubscriptBox["p", "j"]}], "]"}], 
    RowBox[{"SCH", "[", 
     RowBox[{"j", ",", "i"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7214531059220324`*^9, 3.721453139398065*^9}, {
   3.72145414368184*^9, 3.721454144752252*^9}, {3.721560141790056*^9, 
   3.721560147790235*^9}, {3.721560869012299*^9, 3.721560871701084*^9}, 
   3.721566378989653*^9}],

Cell["Cross-checks of (i j) and ( 1 2 ) symmetry:", "Text",
 CellChangeTimes->{{3.721560057496825*^9, 3.721560078985695*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossCheckS", "[", 
   RowBox[{"in_", ",", "a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"in", "-", 
     RowBox[{"(", 
      RowBox[{"in", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "\[Rule]", "b"}], ",", 
         RowBox[{"b", "\[Rule]", "a"}]}], "}"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"a1_", ",", 
        RowBox[{"b1_", "+", "c1_"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{"a1", ",", "b1"}], "]"}], "+", 
       RowBox[{"sp", "[", 
        RowBox[{"a1", ",", "c1"}], "]"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.721638163568445*^9, 3.721638278796267*^9}, {
  3.721638411735127*^9, 3.721638462103491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"SPartial", ",", "i", ",", "j"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"SPartial", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.721638280755641*^9, 3.7216383076209908`*^9}, {
  3.721638549424591*^9, 3.721638553678721*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.7216382999569683`*^9, 3.721638307932345*^9}, 
   3.7216384642678223`*^9, 3.721638554106346*^9, 3.721639427485354*^9, 
   3.721644952429152*^9, 3.721645086169951*^9, 3.721671503994245*^9, 
   3.721671981416189*^9, 3.721676849515394*^9, 3.7217248704743347`*^9, 
   3.722060175443096*^9, 3.722064799651701*^9, 3.7220717888657103`*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.7216382999569683`*^9, 3.721638307932345*^9}, 
   3.7216384642678223`*^9, 3.721638554106346*^9, 3.721639427485354*^9, 
   3.721644952429152*^9, 3.721645086169951*^9, 3.721671503994245*^9, 
   3.721671981416189*^9, 3.721676849515394*^9, 3.7217248704743347`*^9, 
   3.722060175443096*^9, 3.722064799651701*^9, 3.722071788866096*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721638256787388*^9, 3.7216382620694237`*^9}}],

Cell[TextData[{
 "It it convenient to group contributions of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "=", "SPartial"}], TraditionalForm]]],
 " according to the following identity \n\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sum]", 
    RowBox[{"i", ",", "j"}]], TraditionalForm]]],
 "  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "i"], "\[CenterDot]", " ", 
     SubscriptBox["T", "j"]}], " ", 
    SubscriptBox["S", "ij"], " "}], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"(", 
       RowBox[{"i", " ", "<", "j"}], ")"}]], "  ", 
     RowBox[{
      RowBox[{
       SubscriptBox["T", "i"], "\[CenterDot]", " ", 
       SubscriptBox["T", "j"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["S", 
         RowBox[{"ij", " "}]], "+", 
        SubscriptBox["S", "ji"], "-", 
        SubscriptBox["S", "ii"], "-", 
        SubscriptBox["S", "jj"]}], ")"}]}]}]}], TraditionalForm]]],
 ",\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["STotal", "ij"], " ", "===", "  ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["S", 
       RowBox[{"ij", " "}]], "+", 
      SubscriptBox["S", "ji"], "-", 
      SubscriptBox["S", "ii"], "-", 
      SubscriptBox["S", "jj"]}], ")"}]}], TraditionalForm]]],
 " , i.e."
}], "Text",
 CellChangeTimes->{{3.721560618770596*^9, 3.72156068024057*^9}, {
  3.721560743362754*^9, 3.7215608636307507`*^9}, {3.721560896887911*^9, 
  3.7215611395638933`*^9}, {3.721561170660932*^9, 3.721561172868882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"STotal", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"SPartial", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "+", 
    RowBox[{"SPartial", "[", 
     RowBox[{"j", ",", "i"}], "]"}], "-", 
    RowBox[{"SPartial", "[", 
     RowBox[{"i", ",", "i"}], "]"}], "-", 
    RowBox[{"SPartial", "[", 
     RowBox[{"j", ",", "j"}], "]"}]}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"sp", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.721411933611147*^9, 3.721412022003343*^9}, {
   3.721412161253188*^9, 3.721412163164929*^9}, {3.7214122135967627`*^9, 
   3.7214122163149843`*^9}, {3.7214493240823793`*^9, 3.721449386160365*^9}, 
   3.721452430251823*^9, {3.7214531511924686`*^9, 3.7214531670946608`*^9}}],

Cell["", "Text",
 CellChangeTimes->{{3.7215611544611883`*^9, 3.721561158596341*^9}}],

Cell["Cross-checks of reparametrization invariance:", "Text",
 CellChangeTimes->{{3.721560057496825*^9, 3.721560078985695*^9}, {
  3.721561191310946*^9, 3.721561196845457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"STotal", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", "a_"}], "]"}], "/;", 
        RowBox[{"a", "=!=", 
         SubscriptBox["p", "i"]}]}], "\[RuleDelayed]", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", "a"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"\[Lambda]", "^", "2"}], " ", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["p", "i"]}], "]"}]}]}]}], "}"}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FreeQ", "[", 
  RowBox[{"%", ",", "\[Lambda]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"STotal", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", "a_"}], "]"}], "/;", 
        RowBox[{"a", "=!=", 
         SubscriptBox["p", "j"]}]}], "\[RuleDelayed]", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", "a"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["p", "j"]}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"\[Lambda]", "^", "2"}], " ", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["p", "j"]}], "]"}]}]}]}], "}"}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FreeQ", "[", 
  RowBox[{"%", ",", "\[Lambda]"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.721412026948819*^9, 3.7214121260667152`*^9}, {
  3.7214122279314404`*^9, 3.7214122446280403`*^9}, {3.721412469387702*^9, 
  3.721412563615683*^9}, {3.721412716424581*^9, 3.721412757345899*^9}, {
  3.721561199575214*^9, 3.721561199800425*^9}}],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721412484852076*^9, 3.721412564260173*^9}, {
   3.721412693107306*^9, 3.7214127582165613`*^9}, 3.721414553517511*^9, 
   3.7214493920258093`*^9, 3.721450333139874*^9, 3.721450784691338*^9, 
   3.721452263125249*^9, 3.721453170798231*^9, 3.7214539216239862`*^9, 
   3.7214616189321823`*^9, 3.7214655578390093`*^9, {3.7215611782795258`*^9, 
   3.7215612011089983`*^9}, 3.7215653524963837`*^9, 3.721566396028555*^9, 
   3.721566451160576*^9, 3.721567345323526*^9, 3.72163157368979*^9, 
   3.721637655841543*^9, 3.721639427922221*^9, 3.721644952869611*^9, 
   3.721645086644356*^9, 3.721671504690377*^9, 3.7216719818528*^9, 
   3.721676850090472*^9, 3.721724870976824*^9, 3.7220601757609673`*^9, 
   3.722064799873382*^9, 3.7220717890930767`*^9}],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721412484852076*^9, 3.721412564260173*^9}, {
   3.721412693107306*^9, 3.7214127582165613`*^9}, 3.721414553517511*^9, 
   3.7214493920258093`*^9, 3.721450333139874*^9, 3.721450784691338*^9, 
   3.721452263125249*^9, 3.721453170798231*^9, 3.7214539216239862`*^9, 
   3.7214616189321823`*^9, 3.7214655578390093`*^9, {3.7215611782795258`*^9, 
   3.7215612011089983`*^9}, 3.7215653524963837`*^9, 3.721566396028555*^9, 
   3.721566451160576*^9, 3.721567345323526*^9, 3.72163157368979*^9, 
   3.721637655841543*^9, 3.721639427922221*^9, 3.721644952869611*^9, 
   3.721645086644356*^9, 3.721671504690377*^9, 3.7216719818528*^9, 
   3.721676850090472*^9, 3.721724870976824*^9, 3.7220601757609673`*^9, 
   3.722064799873382*^9, 3.722071789127499*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Double emissions tensor of Catani Grazzini with massive partons\
\>", "Subsection",
 CellChangeTimes->{{3.7212075606195583`*^9, 3.7212075690833683`*^9}, {
  3.72156200923345*^9, 3.7215620131201363`*^9}, {3.721562406599434*^9, 
  3.721562409149002*^9}}],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"sp", ",", "Orderless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"dlt", ",", "Orderless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"CenterDot", ",", "Orderless"}], "]"}]}], "Input",
 CellChangeTimes->{{3.721353446028957*^9, 3.721353466113278*^9}, {
   3.721353589659684*^9, 3.721353594262948*^9}, {3.721353653287546*^9, 
   3.721353655696871*^9}, {3.721353737365817*^9, 3.7213537639838667`*^9}, {
   3.721364455401043*^9, 3.721364464823641*^9}, 3.72156123721743*^9, 
   3.721563146497746*^9, {3.721565404292549*^9, 3.721565415188992*^9}}],

Cell[CellGroupData[{

Cell["Feynman rules derinitons", "Subsubsection",
 CellChangeTimes->{{3.721561244902767*^9, 3.721561283453403*^9}}],

Cell[TextData[{
 "Tripple gluon vertex contribution, the terms proportional to sw1 depend \
only on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "+", 
    SubscriptBox["q", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ". To include the complete tripple gluon vertex set (sw1->1). To swicht off \
the contributions of the fermion bubbles set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["sw0", "2"], "\[Rule]", 
    RowBox[{
     RowBox[{"0", " ", "and", " ", "sw0"}], "\[Rule]", "1."}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.721561647252187*^9, 3.721561655556663*^9}, {
  3.7215620221295633`*^9, 3.721562126105308*^9}, {3.7215622275788717`*^9, 
  3.721562347448143*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"\[Mu]1_", ",", "\[Mu]2_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{"(*", 
   FractionBox[
    RowBox[{"fv", "[", 
     RowBox[{"pi", ",", "\[Alpha]"}], "]"}], 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"pi", ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], "]"}], "2", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], "]"}]}]], "*)"}], 
  RowBox[{"sw0", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"fv", "[", 
          RowBox[{
           SubscriptBox["q", "1"], ",", "\[Mu]2"}], "]"}]}], "+", 
        RowBox[{"sw1", " ", 
         RowBox[{"fv", "[", 
          RowBox[{
           SubscriptBox["q", "2"], ",", "\[Mu]2"}], "]"}]}]}], ")"}], 
      RowBox[{"dlt", "[", 
       RowBox[{"\[Alpha]", ",", "\[Mu]1"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["q", "2"], ",", "\[Alpha]"}], "]"}], "-", 
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", "\[Alpha]"}], "]"}]}], ")"}], 
      RowBox[{"dlt", "[", 
       RowBox[{"\[Mu]1", ",", "\[Mu]2"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"fv", "[", 
          RowBox[{
           SubscriptBox["q", "2"], ",", "\[Mu]1"}], "]"}]}], "+", 
        RowBox[{"sw1", " ", 
         RowBox[{"fv", "[", 
          RowBox[{
           SubscriptBox["q", "1"], ",", "\[Mu]1"}], "]"}]}]}], ")"}], 
      RowBox[{"dlt", "[", 
       RowBox[{"\[Alpha]", ",", "\[Mu]2"}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.721353398228093*^9, 3.7213534158039913`*^9}, {
   3.721353508616508*^9, 3.7213535092780046`*^9}, 3.721353587481133*^9, {
   3.721412849111305*^9, 3.7214128523649483`*^9}, {3.721413576267971*^9, 
   3.721413611132567*^9}, {3.7214137510029593`*^9, 3.721413757435141*^9}, {
   3.721414025146975*^9, 3.72141403017715*^9}, {3.721414218268305*^9, 
   3.721414238506023*^9}, {3.72156203880053*^9, 3.721562040056797*^9}, {
   3.721562270131139*^9, 3.7215622720742617`*^9}, {3.721565087089472*^9, 
   3.7215650928894978`*^9}}],

Cell["\<\
Metric tensor, the gauge terms are obtained by setting sw2 -> 1\
\>", "Text",
 CellChangeTimes->{{3.7215616621723948`*^9, 3.721561665165174*^9}, {
  3.7215621898555717`*^9, 3.721562220955014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mt", "[", 
   RowBox[{"a_", ",", "b_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dlt", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "+", 
   RowBox[{"sw2", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"fv", "[", 
        RowBox[{"n", ",", "a"}], "]"}], 
       RowBox[{"fv", "[", 
        RowBox[{"q", ",", "b"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"fv", "[", 
        RowBox[{"q", ",", "a"}], "]"}], 
       RowBox[{"fv", "[", 
        RowBox[{"n", ",", "b"}], "]"}]}]}], 
     RowBox[{"sp", "[", 
      RowBox[{"n", ",", "q"}], "]"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.7213536503464537`*^9, 3.72135372196483*^9}, 
   3.721353859944283*^9, 3.72141284375777*^9, {3.721414033248891*^9, 
   3.721414033544941*^9}, {3.7214729303677473`*^9, 3.7214729306129427`*^9}, 
   3.721562043136693*^9}],

Cell["Function to contract Lorentz indices", "Text",
 CellChangeTimes->{{3.721561292677186*^9, 3.7215613139339733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ct", "[", "in_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"in", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", " ", 
      RowBox[{"tmp", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"fv", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], 
          RowBox[{"dlt", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"fv", "[", 
          RowBox[{"a", ",", "c"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", " ", 
      RowBox[{"tmp", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dlt", "[", 
           RowBox[{"b_", ",", "d_"}], "]"}], 
          RowBox[{"dlt", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"dlt", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", " ", 
      RowBox[{"tmp", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dlt", "[", 
          RowBox[{"b_", ",", "b_"}], "]"}], "\[RuleDelayed]", "d"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", " ", 
      RowBox[{"tmp", "//.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"dlt", "[", 
           RowBox[{"b_", ",", "c_"}], "]"}], "2"], "\[RuleDelayed]", "d"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", " ", 
      RowBox[{"tmp", " ", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"fv", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], 
          RowBox[{"fv", "[", 
           RowBox[{"c_", ",", "b_"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", "c"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", " ", 
      RowBox[{"tmp", "//.", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"fv", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "2"], "\[RuleDelayed]", 
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", "a"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.721310629768524*^9, 3.721310782638996*^9}, {
   3.721352810685498*^9, 3.721352813556058*^9}, {3.721352873097999*^9, 
   3.7213528731315393`*^9}, {3.721352909491269*^9, 3.721352918859844*^9}, {
   3.721353204139155*^9, 3.721353205714641*^9}, 3.72135330751497*^9, 
   3.7213533453157*^9, {3.7213534347964163`*^9, 3.7213535008944407`*^9}, {
   3.7213535429301977`*^9, 3.7213535557935677`*^9}, {3.721353644976912*^9, 
   3.721353646640587*^9}, {3.7213538684410133`*^9, 3.721353874095113*^9}, {
   3.721355118397648*^9, 3.721355119363474*^9}, {3.7214134076775513`*^9, 
   3.721413473841893*^9}, {3.721414377974142*^9, 3.7214144042858047`*^9}, {
   3.721561288703336*^9, 3.721561288838312*^9}}],

Cell["Function to introduce an Eikonal emission:", "Text",
 CellChangeTimes->{{3.721561317653743*^9, 3.7215613222783003`*^9}, {
  3.721561354950725*^9, 3.72156136657518*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eik", "[", 
   RowBox[{"i_", ",", "n_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"i", ",", 
      SubscriptBox["a", "n"]}], "]"}], ",", 
    FractionBox[
     RowBox[{"fv", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["\[Alpha]", "n"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", "q"}], "]"}]]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eik", "[", 
   RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"i", ",", 
      SubscriptBox["a", "n"]}], "]"}], ",", 
    FractionBox[
     RowBox[{"fv", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["\[Alpha]", "n"]}], "]"}], 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "n"]}], "]"}]]}], "}"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvZTVqXHJzteOPY1STSA6/kHSVBDdd/LuTBA97XTr
QhDtqxS7FEQfCs5dA6L37/y5BUT7NEbtBNHzQoR3geiCFYtPgmhH7ZbHIDpv
9vZXIHrDnMwvILpoVvVvEH1EaA37UiAd5cnOD6LZdiaKgOhQozU2IPpN11EX
EL1p/heOKyBzhU9KgOikZy9DQPT+hl9g2tsrejaIPsZzeC6IfqZYtR1Ea4gz
7gLRbA9zDoNoi/LdYHpp6Z3nIPrcibpXIFrmYPn3q0D6uLveDxDtEbXk2Csg
zSdbdRxE+/x79BhEf1A//wREe80N5H0NUrezCUwDAN+Gvn8=
  "]],

Cell["Function to multiply to Eikonal emissions:", "Text",
 CellChangeTimes->{{3.721561331374236*^9, 3.7215613682712107`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Prod", "[", "in_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", ",", "ic"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ic", "=", "1"}], ",", 
       RowBox[{"ic", "\[LessEqual]", 
        RowBox[{"Length", "[", "in", "]"}]}], ",", 
       RowBox[{"ic", "++"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tmp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"in", "[", 
             RowBox[{"[", "ic", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "=", 
         RowBox[{"Ct", "[", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", " ", 
           RowBox[{
            RowBox[{"in", "[", 
             RowBox[{"[", "ic", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}]}], " ", ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.721306345659329*^9, 3.7213067048830853`*^9}, {
   3.721306744075829*^9, 3.72130678190797*^9}, {3.721306871035915*^9, 
   3.721306972023271*^9}, {3.721307042856696*^9, 3.721307047887084*^9}, 
   3.721307116964237*^9, {3.7213072290654087`*^9, 3.7213072294235764`*^9}, {
   3.72130726350051*^9, 3.721307277170967*^9}, {3.72130730734649*^9, 
   3.721307332378997*^9}, {3.7213073888567467`*^9, 3.721307389168786*^9}, {
   3.721310756927849*^9, 3.721310761222579*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Double soft-gluon emission tensor K", "Subsubsection",
 CellChangeTimes->{{3.721561692525393*^9, 3.721561713910047*^9}}],

Cell["\<\
Armed with the definitions in this section, we can now write each fo the terms 
in Eq (101)  of  arXiv:hep-ph/9908523\
\>", "Text",
 CellChangeTimes->{{3.7215616042995987`*^9, 3.721561636084052*^9}, {
  3.721561950760419*^9, 3.721561965166788*^9}, {3.721562417179661*^9, 
  3.7215624311255703`*^9}, {3.721562560905884*^9, 3.721562565537189*^9}}],

Cell["Double emissions from parton i and from parton j:", "Text",
 CellChangeTimes->{{3.7215625229208393`*^9, 3.721562528704282*^9}, {
  3.7215625696489162`*^9, 3.7215625785295887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ksame", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Prod", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Eik", "[", 
        RowBox[{"i", ",", "1"}], "]"}], ",", 
       RowBox[{"Eik", "[", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Prod", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Eik", "[", 
        RowBox[{"i", ",", "2"}], "]"}], ",", 
       RowBox[{"Eik", "[", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Prod", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Eik", "[", 
        RowBox[{"j", ",", "1"}], "]"}], ",", 
       RowBox[{"Eik", "[", 
        RowBox[{"j", ",", "2", ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Prod", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Eik", "[", 
        RowBox[{"j", ",", "2"}], "]"}], ",", 
       RowBox[{"Eik", "[", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], "]"}]}], "}"}], "]"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7213068283584414`*^9, 3.7213068572827578`*^9}, {
   3.721306921262598*^9, 3.72130693594976*^9}, {3.72130738083983*^9, 
   3.721307423884335*^9}, {3.7213074865814247`*^9, 3.721307492125744*^9}, {
   3.721307538576456*^9, 3.721307573208446*^9}, {3.721307617634766*^9, 
   3.721307664833749*^9}, 3.7213077903503323`*^9, {3.721309686873752*^9, 
   3.721309695289486*^9}, {3.721309749244837*^9, 3.721309776664844*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "(", 
         RowBox[{"i", ",", 
          SubscriptBox["a", "1"]}], ")"}], ",", 
        RowBox[{"T", "(", 
         RowBox[{"i", ",", 
          SubscriptBox["a", "2"]}], ")"}]}], "}"}], 
      FractionBox[
       RowBox[{
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "1"]}], ")"}], " ", 
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "(", 
         RowBox[{"i", ",", 
          SubscriptBox["a", "2"]}], ")"}], ",", 
        RowBox[{"T", "(", 
         RowBox[{"i", ",", 
          SubscriptBox["a", "1"]}], ")"}]}], "}"}], 
      FractionBox[
       RowBox[{
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "1"]}], ")"}], " ", 
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "(", 
         RowBox[{"j", ",", 
          SubscriptBox["a", "1"]}], ")"}], ",", 
        RowBox[{"T", "(", 
         RowBox[{"j", ",", 
          SubscriptBox["a", "2"]}], ")"}]}], "}"}], 
      FractionBox[
       RowBox[{
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["\[Alpha]", "1"]}], ")"}], " ", 
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["\[Alpha]", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "1"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "(", 
         RowBox[{"j", ",", 
          SubscriptBox["a", "2"]}], ")"}], ",", 
        RowBox[{"T", "(", 
         RowBox[{"j", ",", 
          SubscriptBox["a", "1"]}], ")"}]}], "}"}], 
      FractionBox[
       RowBox[{
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["\[Alpha]", "1"]}], ")"}], " ", 
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["\[Alpha]", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.721306839982828*^9, 3.721306857879058*^9}, {
   3.7213069059627037`*^9, 3.72130693643146*^9}, 3.721306975407092*^9, 
   3.7213070500487347`*^9, 3.72130719701292*^9, {3.721307232628443*^9, 
   3.721307237029942*^9}, {3.721307269638111*^9, 3.721307279639332*^9}, {
   3.7213073116538773`*^9, 3.721307337886221*^9}, {3.721307385938534*^9, 
   3.7213074122973547`*^9}, 3.72130749245081*^9, {3.721307633313922*^9, 
   3.7213076804986963`*^9}, 3.721307798378358*^9, 3.7213082382000713`*^9, 
   3.721308762542161*^9, 3.721309695985815*^9, {3.721309768701215*^9, 
   3.721309777290997*^9}, 3.721310149447221*^9, {3.721310764980791*^9, 
   3.721310793977646*^9}, 3.721312540062484*^9, {3.721313309934196*^9, 
   3.72131331205586*^9}, 3.721313376714333*^9, 3.7213134168025208`*^9, 
   3.721351369266151*^9, {3.7213527412947407`*^9, 3.721352785263215*^9}, {
   3.721352892374853*^9, 3.721352921805216*^9}, {3.721353001012336*^9, 
   3.7213530106508007`*^9}, 3.721353046376013*^9, 3.721353228420965*^9, {
   3.7213533307088842`*^9, 3.7213533479716263`*^9}, 3.721353517222262*^9, {
   3.721353567744644*^9, 3.721353597454631*^9}, 3.7213537939338913`*^9, 
   3.721355125790758*^9, 3.721356814718361*^9, 3.721358497525137*^9, 
   3.7213612384985533`*^9, 3.7213620717182617`*^9, 3.7213626661826687`*^9, 
   3.721362833450101*^9, 3.721363050223575*^9, 3.721363142626067*^9, 
   3.721363396304317*^9, 3.721363555983758*^9, 3.721363714447904*^9, 
   3.721364091821157*^9, 3.721364157215954*^9, 3.721364200722435*^9, {
   3.721364437756238*^9, 3.7213644673144417`*^9}, 3.721380383303607*^9, 
   3.7213808192349*^9, 3.7213815687394*^9, 3.721381687592683*^9, 
   3.7213823836398487`*^9, 3.721382569398493*^9, 3.721383492680632*^9, {
   3.721412833559348*^9, 3.7214128579232492`*^9}, 3.7214129373682117`*^9, {
   3.721412978148855*^9, 3.7214129975201387`*^9}, 3.7214135396012697`*^9, 
   3.721413613895114*^9, {3.721413765488*^9, 3.721413784896042*^9}, 
   3.7214139536486187`*^9, 3.7214140383019543`*^9, 3.721414153205269*^9, 
   3.721414241721381*^9, 3.721414408223756*^9, 3.721414769735817*^9, 
   3.721416097107047*^9, 3.7214465985689096`*^9, 3.7214488583765793`*^9, 
   3.721450682654352*^9, 3.72145385521749*^9, 3.721461620163817*^9, 
   3.7214655601033373`*^9, 3.721472072212295*^9, 3.7214728404181423`*^9, 
   3.721472934402252*^9, 3.7215631925411797`*^9, 3.7215651068831997`*^9, 
   3.7215653526802883`*^9, 3.721565427561973*^9, 3.721566451721601*^9, 
   3.721566853546282*^9, 3.7215673455558977`*^9, 3.721631574075088*^9, 
   3.721637656027766*^9, 3.7216394281815443`*^9, 3.721644953181449*^9, 
   3.7216450869314337`*^9, 3.721671505011874*^9, 3.721671982523753*^9, 
   3.7216768503393307`*^9, 3.721724871274049*^9, 3.722060175862639*^9, 
   3.722064800074457*^9, 3.722071789220531*^9}]
}, Open  ]],

Cell["Double emissions two different partons i j:", "Text",
 CellChangeTimes->{{3.7215625229208393`*^9, 3.721562528704282*^9}, {
  3.7215625696489162`*^9, 3.721562598521695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Kdif", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Prod", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Eik", "[", 
        RowBox[{"i", ",", "1"}], "]"}], ",", 
       RowBox[{"Eik", "[", 
        RowBox[{"j", ",", "2"}], "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Prod", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Eik", "[", 
        RowBox[{"i", ",", "2"}], "]"}], ",", 
       RowBox[{"Eik", "[", 
        RowBox[{"j", ",", "1"}], "]"}]}], "}"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.721307518736218*^9, 3.721307530432604*^9}, {
  3.721307704315213*^9, 3.72130773118025*^9}, {3.72130969873761*^9, 
  3.7213097013219*^9}, {3.721309971170185*^9, 3.721309973609836*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "(", 
         RowBox[{"i", ",", 
          SubscriptBox["a", "1"]}], ")"}], ",", 
        RowBox[{"T", "(", 
         RowBox[{"j", ",", 
          SubscriptBox["a", "2"]}], ")"}]}], "}"}], 
      FractionBox[
       RowBox[{
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "1"]}], ")"}], " ", 
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["\[Alpha]", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "2"]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "(", 
         RowBox[{"i", ",", 
          SubscriptBox["a", "2"]}], ")"}], ",", 
        RowBox[{"T", "(", 
         RowBox[{"j", ",", 
          SubscriptBox["a", "1"]}], ")"}]}], "}"}], 
      FractionBox[
       RowBox[{
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "2"]}], ")"}], " ", 
        RowBox[{"fv", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["\[Alpha]", "1"]}], ")"}]}], 
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "1"]}], ")"}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.7213077230936832`*^9, 3.721307731696466*^9}, 
   3.7213078021057053`*^9, 3.721309702010947*^9, 3.721309790076058*^9, 
   3.7213098301707983`*^9, 3.721309882346469*^9, 3.721309974417728*^9, 
   3.721310153742251*^9, 3.721310799262192*^9, 3.721312540109058*^9, 
   3.721313376764811*^9, 3.721313416847192*^9, 3.721351369289904*^9, {
   3.721352773066416*^9, 3.72135278531012*^9}, 3.7213528924226*^9, 
   3.721352924030446*^9, {3.721353001045512*^9, 3.721353010697424*^9}, {
   3.72135333075121*^9, 3.721353348015329*^9}, 3.721353517275161*^9, {
   3.721353567803001*^9, 3.721353597493373*^9}, 3.7213537973124647`*^9, 
   3.7213551284305973`*^9, 3.721356814770998*^9, 3.721358497569252*^9, 
   3.7213612385394697`*^9, 3.7213620717643538`*^9, 3.721362666216165*^9, 
   3.721362833488378*^9, 3.721363050269677*^9, 3.721363142663733*^9, 
   3.721363396325523*^9, 3.721363556033779*^9, 3.721363714495714*^9, 
   3.721364091866334*^9, 3.721364157242691*^9, 3.7213642007675877`*^9, {
   3.7213644377934427`*^9, 3.721364467350691*^9}, 3.721380383356094*^9, 
   3.721380819283593*^9, 3.721381568771946*^9, 3.7213816876143217`*^9, 
   3.721382383661088*^9, 3.721382569449185*^9, 3.721383492726595*^9, {
   3.721412833606103*^9, 3.721412857978299*^9}, 3.721412937418376*^9, {
   3.721412978200285*^9, 3.7214129975682096`*^9}, 3.721413539642009*^9, 
   3.721413613940275*^9, {3.721413765536916*^9, 3.721413784942882*^9}, 
   3.7214139536894484`*^9, 3.721414038347434*^9, 3.7214141532547092`*^9, 
   3.7214142417679663`*^9, 3.721414408263139*^9, 3.721414769776964*^9, 
   3.721416097148095*^9, 3.721446598594577*^9, 3.721448858511322*^9, 
   3.721450682695984*^9, 3.7214538552663918`*^9, 3.7214616202168503`*^9, 
   3.721465560142164*^9, 3.721472072260539*^9, 3.721472840458747*^9, 
   3.7214729344457827`*^9, 3.721563192595343*^9, 3.721565106947579*^9, 
   3.721565352733418*^9, 3.721565427617509*^9, 3.721566451776528*^9, 
   3.721566853596732*^9, 3.7215673456067457`*^9, 3.721631574109198*^9, 
   3.721637656164257*^9, 3.721639428223638*^9, 3.721644953225381*^9, 
   3.721645086976304*^9, 3.72167150506989*^9, 3.7216719826050863`*^9, 
   3.721676850376977*^9, 3.7217248713295813`*^9, 3.722060175882704*^9, 
   3.7220648000962763`*^9, 3.722071789251976*^9}]
}, Open  ]],

Cell["Emission via a tripple gluon vertex:", "Text",
 CellChangeTimes->{{3.7213077437334547`*^9, 3.721307749532893*^9}, 
   3.721307805086204*^9, {3.721562602932279*^9, 3.721562609154356*^9}, {
   3.721562650461577*^9, 3.721562652002963*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mtG", "[", 
   RowBox[{"a_", ",", "b_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dlt", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "+", 
   RowBox[{"sw3", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"fv", "[", 
        RowBox[{"n", ",", "a"}], "]"}], 
       RowBox[{"fv", "[", 
        RowBox[{"q", ",", "b"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"fv", "[", 
        RowBox[{"q", ",", "a"}], "]"}], 
       RowBox[{"fv", "[", 
        RowBox[{"n", ",", "b"}], "]"}]}]}], 
     RowBox[{"sp", "[", 
      RowBox[{"n", ",", "q"}], "]"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.7213536503464537`*^9, 3.72135372196483*^9}, 
   3.721353859944283*^9, 3.72141284375777*^9, {3.721414033248891*^9, 
   3.721414033544941*^9}, {3.7214729303677473`*^9, 3.7214729306129427`*^9}, 
   3.721562043136693*^9, 3.721567240376257*^9, {3.72156729654498*^9, 
   3.7215672966069717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bubb", "[", "i_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Tq", "[", 
       RowBox[{
        SubscriptBox["a", "1"], ",", 
        SubscriptBox["a", "2"], ",", 
        RowBox[{"rc", "[", 
         RowBox[{"sc", "+=", "1"}], "]"}]}], "]"}], ",", 
      RowBox[{"T", "[", 
       RowBox[{"i", ",", 
        RowBox[{"rc", "[", "sc", "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Ct", "[", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{
        SubscriptBox["\[Alpha]", "1"], ",", 
        SubscriptBox["\[Alpha]", "2"], ",", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"sc", "+=", "1"}]]}], "]"}], 
      RowBox[{"mtG", "[", 
       RowBox[{
        SubscriptBox["\[Alpha]", "sc"], ",", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"sc", "+=", "1"}]], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["\[Alpha]", "sc"]}], "]"}]}], 
       RowBox[{"2", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], "]"}]}]]}], "]"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.721307831554398*^9, 3.721307834251306*^9}, {
   3.721307953482177*^9, 3.721307955024926*^9}, {3.721307992075275*^9, 
   3.721308213038094*^9}, {3.721308247999789*^9, 3.721308324882779*^9}, {
   3.7213100822955837`*^9, 3.721310088662075*^9}, {3.721310309673073*^9, 
   3.721310389727487*^9}, {3.72141351093826*^9, 3.721413533694276*^9}, {
   3.72141387701679*^9, 3.721413940843006*^9}, {3.7214141409744062`*^9, 
   3.7214141451410637`*^9}, {3.721414763400425*^9, 3.7214147672146797`*^9}, {
   3.721416091488721*^9, 3.7214160925746613`*^9}, {3.721562694397881*^9, 
   3.721562709413011*^9}, 3.7215670128631687`*^9, {3.721567061336205*^9, 
   3.721567147878908*^9}, {3.721567186657743*^9, 3.721567248842325*^9}, {
   3.721567322503806*^9, 3.7215673230398827`*^9}}],

Cell["BubbAxial (sw3->1) and Feynman gauge (sw3->0)", "Text",
 CellChangeTimes->{{3.721562831538074*^9, 3.721562868570108*^9}, {
  3.7215670244539633`*^9, 3.7215670345904093`*^9}, {3.72156729911087*^9, 
  3.7215673194791203`*^9}}],

Cell[BoxData[
 RowBox[{"KBubb", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Bubb", "[", "i", "]"}], ",", 
    RowBox[{"Bubb", "[", "j", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.721309890584206*^9, 3.721309909658702*^9}, 
   3.7213100558788977`*^9, {3.7215628148985653`*^9, 3.721562821284336*^9}, {
   3.721566839252853*^9, 3.721566844947283*^9}, {3.721567015165834*^9, 
   3.721567017253788*^9}}],

Cell["\<\
The double emission tensor that includes all emissions from i and from j \
yields:\
\>", "Text",
 CellChangeTimes->{{3.721562877547307*^9, 3.721562928780822*^9}}],

Cell[BoxData[
 RowBox[{"Kij", ":=", 
  RowBox[{"Join", "[", 
   RowBox[{"Ksame", ",", "Kdif", ",", "KBubb"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7213096839226627`*^9, 3.7213097204576693`*^9}, {
   3.721309913380413*^9, 3.721309934903285*^9}, 3.721313965296136*^9, {
   3.721562934271495*^9, 3.7215629343747396`*^9}, {3.721564808068946*^9, 
   3.721564815564624*^9}, {3.721644160612967*^9, 3.72164416454023*^9}}],

Cell["Its hermitian conjugate corresponds to ", "Text",
 CellChangeTimes->{{3.721562942374181*^9, 3.7215629557575808`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KijC", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Kij", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "[", "a__", "]"}], ",", 
          RowBox[{"T", "[", "b__", "]"}]}], "}"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"T", "[", "b", "]"}], ",", 
          RowBox[{"T", "[", "a", "]"}]}], "}"}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tq", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"Tq", "[", 
        RowBox[{"c", ",", "b", ",", "a"}], "]"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", "\[Rule]", "\[Beta]"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721309988611568*^9, 3.721310029581218*^9}, {
   3.7213100680296392`*^9, 3.721310114935123*^9}, 3.72131017153819*^9, 
   3.7213130806483517`*^9, {3.7213538169880238`*^9, 3.721353835509254*^9}, {
   3.721355001157858*^9, 3.721355016779973*^9}, 3.721363711212665*^9, {
   3.7215629362144947`*^9, 3.721562939238779*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-section level", "Subsubsection",
 CellChangeTimes->{{3.721563119770091*^9, 3.721563124434154*^9}}],

Cell[TextData[{
 "Hence at cross-section level ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Kij2", "===", " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "Kij* Kij yields"
}], "Text",
 CellChangeTimes->{
  3.721563115180209*^9, {3.721563165673259*^9, 3.72156317979504*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kij2", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"Kij2", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Plus", "@@", " ", 
         RowBox[{"ReadableNotation", "[", " ", 
          RowBox[{"ColourSimplify", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"KijC", "[", 
               RowBox[{"[", "jc", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"Kij", "[", 
               RowBox[{"[", "ic", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "  ", "]"}], " ", 
          "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"Ct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KijC", "[", 
            RowBox[{"[", "jc", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mt", "[", 
             RowBox[{
              SubscriptBox["\[Beta]", "1"], ",", 
              SubscriptBox["\[Alpha]", "1"], ",", 
              SubscriptBox["q", "1"]}], "]"}], 
            RowBox[{"mt", "[", 
             RowBox[{
              SubscriptBox["\[Beta]", "2"], ",", 
              SubscriptBox["\[Alpha]", "2"], ",", 
              SubscriptBox["q", "2"]}], "]"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{"Kij", "[", 
            RowBox[{"[", "ic", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ")"}]}]}], " ", "]"}], 
    "  ", ";"}], "\[IndentingNewLine]", " ", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"jc", ",", "1", ",", 
     RowBox[{"Length", "[", "KijC", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ic", ",", "1", ",", 
     RowBox[{"Length", "[", "Kij", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.721310187052576*^9, 3.7213102612655983`*^9}, {
   3.721310406722269*^9, 3.721310595459993*^9}, {3.7213108265215893`*^9, 
   3.72131086397093*^9}, {3.721310997833537*^9, 3.721311022194316*^9}, 
   3.721312725140554*^9, {3.721312776644855*^9, 3.721312840192271*^9}, {
   3.721353080055379*^9, 3.721353089960301*^9}, {3.7213531698386803`*^9, 
   3.721353176268599*^9}, {3.7213549895729523`*^9, 3.721354989770329*^9}, {
   3.721355033207223*^9, 3.721355070272254*^9}, {3.7213552482220287`*^9, 
   3.721355261838479*^9}, {3.721364142245255*^9, 3.7213641537243967`*^9}, {
   3.7213807613084097`*^9, 3.721380763706954*^9}, 3.72138079407192*^9, {
   3.72138260044171*^9, 3.721382689502907*^9}, {3.721382741952479*^9, 
   3.721382801142626*^9}, {3.7213829338565474`*^9, 3.7213829791192503`*^9}, {
   3.721383138001116*^9, 3.721383161743567*^9}, {3.7214728309007473`*^9, 
   3.7214728309629917`*^9}, {3.721563160416452*^9, 3.721563222770935*^9}, {
   3.721563716074429*^9, 3.721563733003891*^9}, 3.7215649715257807`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Length", "[", "Kij2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Kij2", "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.721568711259515*^9, 3.7215687488675756`*^9}}],

Cell[BoxData[
 FormBox["64", TraditionalForm]], "Output",
 CellChangeTimes->{3.721568716217568*^9, 3.7215687491387873`*^9, 
  3.721631584588607*^9, 3.721637666234432*^9, 3.7216394379378843`*^9, 
  3.721644964767681*^9, 3.72164509750981*^9, 3.721671517451956*^9, 
  3.721671993134469*^9, 3.7216768613330717`*^9, 3.721724881149599*^9, 
  3.722060181676195*^9, 3.722064806195654*^9, 3.72207179542139*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["C", "i", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox["sw2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{"n", ",", 
          SubscriptBox["p", "i"]}], ")"}], "2"], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{"n", ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{"n", ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2", " ", "sw2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{"n", ",", 
         SubscriptBox["p", "i"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{"n", ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2", " ", "sw2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{"n", ",", 
         SubscriptBox["p", "i"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{"n", ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}], "2"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.721568716217568*^9, 3.7215687491387873`*^9, 
  3.721631584588607*^9, 3.721637666234432*^9, 3.7216394379378843`*^9, 
  3.721644964767681*^9, 3.72164509750981*^9, 3.721671517451956*^9, 
  3.721671993134469*^9, 3.7216768613330717`*^9, 3.721724881149599*^9, 
  3.722060181676195*^9, 3.722064806195654*^9, 3.72207179544314*^9}]
}, Open  ]],

Cell["There are now in total 8 *8 terms", "Text",
 CellChangeTimes->{{3.721563240712729*^9, 3.721563249488462*^9}, {
  3.7215632988274727`*^9, 3.721563372839141*^9}, {3.7215635468452997`*^9, 
  3.7215635507895184`*^9}, {3.72156358886552*^9, 3.7215636208176126`*^9}, {
  3.7215644801406717`*^9, 3.721564493236038*^9}, {3.721568720427005*^9, 
  3.721568739323491*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison with Czakon - Heymes", "Subsection",
 CellChangeTimes->{{3.7212075606195583`*^9, 3.7212075690833683`*^9}, {
  3.72156200923345*^9, 3.7215620131201363`*^9}, {3.721562406599434*^9, 
  3.721562409149002*^9}, {3.7215686416417913`*^9, 3.721568653241392*^9}}],

Cell[CellGroupData[{

Cell["First line of D.40", "Subsubsection",
 CellChangeTimes->{{3.721564464195798*^9, 3.721564470459553*^9}}],

Cell[TextData[{
 "First, to check that the Abelian terms, i.e. first line of D40. With this \
propose we set ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "A"], "\[Rule]", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{3.721564482446621*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Abeij", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Plus", "@@", "Kij2"}], "/.", 
      RowBox[{"{", 
       RowBox[{"CA", "\[Rule]", "0"}], "}"}]}], ")"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "+", 
       RowBox[{"sp", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721383509953712*^9, 3.721383714362509*^9}, {
   3.721383804238886*^9, 3.721383864327588*^9}, {3.7215633774117804`*^9, 
   3.721563377517523*^9}, {3.721563422395591*^9, 3.721563461860574*^9}, 
   3.72156357677066*^9, {3.721563652586472*^9, 3.721563660567731*^9}, 
   3.72156369508529*^9, {3.72156374034027*^9, 3.721563740905864*^9}, 
   3.721564976998291*^9}],

Cell["\<\
All terms of  D40. that only involve partons i and j are equal to:\
\>", "Text",
 CellChangeTimes->{{3.7215637679648037`*^9, 3.721563788611286*^9}, {
  3.721564099846574*^9, 3.721564120471261*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ek", "[", 
   RowBox[{"i_", ",", "n_", ",", "q_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"fv", "[", 
    RowBox[{
     SubscriptBox["p", "i"], ",", 
     SubscriptBox["\[Alpha]", "n"]}], "]"}], 
   RowBox[{"sp", "[", 
    RowBox[{
     SubscriptBox["p", "i"], ",", "q"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToCompare", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ek", "[", 
       RowBox[{"i", ",", "1", ",", 
        SubscriptBox["q", "1"]}], "]"}], 
      RowBox[{"mt", "[", 
       RowBox[{
        SubscriptBox["\[Beta]", "1"], ",", 
        SubscriptBox["\[Alpha]", "1"], ",", 
        SubscriptBox["q", "1"]}], "]"}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Ek", "[", 
         RowBox[{"j", ",", "1", ",", 
          SubscriptBox["q", "1"]}], "]"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", "\[Beta]"}]}], ")"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ek", "[", 
       RowBox[{"k", ",", "2", ",", 
        SubscriptBox["q", "2"]}], "]"}], 
      RowBox[{"mt", "[", 
       RowBox[{
        SubscriptBox["\[Beta]", "2"], ",", 
        SubscriptBox["\[Alpha]", "2"], ",", 
        SubscriptBox["q", "2"]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Ek", "[", 
         RowBox[{"l", ",", "2", ",", 
          SubscriptBox["q", "2"]}], "]"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", "\[Beta]"}]}], ")"}]}], ")"}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AuxDef1", "=", 
   RowBox[{"8", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["T", "i"], "\[CenterDot]", 
       SubscriptBox["T", "j"]}], ")"}], "2"], "   ", 
    RowBox[{"Ct", "[", 
     RowBox[{"ToCompare", "[", 
      RowBox[{"i", ",", "j", ",", "i", ",", "j"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AuxDef2", "=", 
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["T", "i"], "\[CenterDot]", 
     SubscriptBox["T", "j"]}], 
    SubscriptBox["C", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Ct", "[", 
       RowBox[{"ToCompare", "[", 
        RowBox[{"i", ",", "i", ",", "j", ",", "i"}], "]"}], "]"}], "+", 
      RowBox[{"Ct", "[", 
       RowBox[{"ToCompare", "[", 
        RowBox[{"i", ",", "i", ",", "i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{"Ct", "[", 
       RowBox[{"ToCompare", "[", 
        RowBox[{"i", ",", "j", ",", "i", ",", "i"}], "]"}], "]"}], "+", 
      RowBox[{"Ct", "[", 
       RowBox[{"ToCompare", "[", 
        RowBox[{"j", ",", "i", ",", "i", ",", "i"}], "]"}], "]"}]}], 
     ")"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AuxDef3", "=", 
   RowBox[{"AuxDef2", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "\[Rule]", "j"}], ",", 
      RowBox[{"j", "\[Rule]", "i"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AuxDef4", "=", " ", 
   RowBox[{"2", 
    SuperscriptBox[
     RowBox[{"(", 
      SubscriptBox["C", "i"], ")"}], "2"], 
    RowBox[{"Ct", "[", 
     RowBox[{"ToCompare", "[", 
      RowBox[{"i", ",", "i", ",", "i", ",", "i"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AuxDef5", "=", 
   RowBox[{"AuxDef4", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "\[Rule]", "j"}], ",", 
      RowBox[{"j", "\[Rule]", "i"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AuxDef6", "=", 
   RowBox[{"2", 
    SubscriptBox["C", "i"], 
    SubscriptBox["C", "j"], 
    RowBox[{"Ct", "[", 
     RowBox[{
      RowBox[{"ToCompare", "[", 
       RowBox[{"i", ",", "i", ",", "j", ",", "j"}], "]"}], "+", 
      RowBox[{"ToCompare", "[", 
       RowBox[{"j", ",", "j", ",", "i", ",", "i"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FirstLineEqD40ij", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"(", 
     RowBox[{
     "AuxDef1", "+", "AuxDef2", "+", "AuxDef3", "+", "AuxDef4", "+", 
      "AuxDef5", "+", "AuxDef6"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.721564034426477*^9, 3.721564085592259*^9}, {
   3.721564127265142*^9, 3.7215642990089493`*^9}, {3.721564395139464*^9, 
   3.721564423231489*^9}, {3.721564561703553*^9, 3.721564616840848*^9}, {
   3.721564653920856*^9, 3.7215646886368637`*^9}, {3.721565549389632*^9, 
   3.721565571765875*^9}, {3.721565620209484*^9, 3.721565664540613*^9}, {
   3.721565712206313*^9, 3.7215657211919394`*^9}, 3.7215657964372807`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Abeij", "-", "FirstLineEqD40ij"}], ",", 
    RowBox[{
     SubscriptBox["T", "i"], "\[CenterDot]", 
     SubscriptBox["T", "j"]}], ",", "2"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Abeij", "-", "FirstLineEqD40ij"}], ",", 
    RowBox[{
     SubscriptBox["C", 
      RowBox[{"i", " "}]], 
     RowBox[{
      SubscriptBox["T", "i"], "\[CenterDot]", 
      SubscriptBox["T", "j"]}]}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Abeij", "-", "FirstLineEqD40ij"}], ",", 
    RowBox[{
     SubscriptBox["C", 
      RowBox[{"j", " "}]], 
     RowBox[{
      SubscriptBox["T", "i"], "\[CenterDot]", 
      SubscriptBox["T", "j"]}]}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Abeij", "-", "FirstLineEqD40ij"}], ",", 
    SubscriptBox["C", "i"], ",", "2"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Abeij", "-", "FirstLineEqD40ij"}], ",", 
    SubscriptBox["C", "j"], ",", "2"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Abeij", "-", "FirstLineEqD40ij"}], ",", 
    RowBox[{
     SubscriptBox["C", "i"], 
     SubscriptBox["C", "j"]}]}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{
  3.721564559791711*^9, {3.721564620057475*^9, 3.721564770899323*^9}, {
   3.7215649179957*^9, 3.721564927554525*^9}, {3.721564994652131*^9, 
   3.721564995324284*^9}, {3.721565121625351*^9, 3.721565144603198*^9}, {
   3.721565365467085*^9, 3.721565385226584*^9}, {3.721565441533752*^9, 
   3.721565526446879*^9}, {3.7215655781019983`*^9, 3.721565615049634*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721565509580579*^9, 3.7215655267688313`*^9}, {
   3.721565563930847*^9, 3.721565615627986*^9}, {3.7215656537120743`*^9, 
   3.7215656675592527`*^9}, 3.721565725234832*^9, 3.721565799502618*^9, {
   3.721566041116291*^9, 3.72156608005135*^9}, 3.721566454743464*^9, 
   3.7215668684447117`*^9, 3.721567356954936*^9, 3.721631584794983*^9, 
   3.7216376664611464`*^9, 3.721639438118135*^9, 3.721644965209543*^9, 
   3.7216450977110043`*^9, 3.7216715177745113`*^9, 3.721671993325136*^9, 
   3.721676861526475*^9, 3.7217248813360653`*^9, 3.722060181802537*^9, 
   3.7220648063207207`*^9, 3.722071795591621*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721565509580579*^9, 3.7215655267688313`*^9}, {
   3.721565563930847*^9, 3.721565615627986*^9}, {3.7215656537120743`*^9, 
   3.7215656675592527`*^9}, 3.721565725234832*^9, 3.721565799502618*^9, {
   3.721566041116291*^9, 3.72156608005135*^9}, 3.721566454743464*^9, 
   3.7215668684447117`*^9, 3.721567356954936*^9, 3.721631584794983*^9, 
   3.7216376664611464`*^9, 3.721639438118135*^9, 3.721644965209543*^9, 
   3.7216450977110043`*^9, 3.7216715177745113`*^9, 3.721671993325136*^9, 
   3.721676861526475*^9, 3.7217248813360653`*^9, 3.722060181802537*^9, 
   3.7220648063207207`*^9, 3.722071795610327*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721565509580579*^9, 3.7215655267688313`*^9}, {
   3.721565563930847*^9, 3.721565615627986*^9}, {3.7215656537120743`*^9, 
   3.7215656675592527`*^9}, 3.721565725234832*^9, 3.721565799502618*^9, {
   3.721566041116291*^9, 3.72156608005135*^9}, 3.721566454743464*^9, 
   3.7215668684447117`*^9, 3.721567356954936*^9, 3.721631584794983*^9, 
   3.7216376664611464`*^9, 3.721639438118135*^9, 3.721644965209543*^9, 
   3.7216450977110043`*^9, 3.7216715177745113`*^9, 3.721671993325136*^9, 
   3.721676861526475*^9, 3.7217248813360653`*^9, 3.722060181802537*^9, 
   3.7220648063207207`*^9, 3.722071795631351*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721565509580579*^9, 3.7215655267688313`*^9}, {
   3.721565563930847*^9, 3.721565615627986*^9}, {3.7215656537120743`*^9, 
   3.7215656675592527`*^9}, 3.721565725234832*^9, 3.721565799502618*^9, {
   3.721566041116291*^9, 3.72156608005135*^9}, 3.721566454743464*^9, 
   3.7215668684447117`*^9, 3.721567356954936*^9, 3.721631584794983*^9, 
   3.7216376664611464`*^9, 3.721639438118135*^9, 3.721644965209543*^9, 
   3.7216450977110043`*^9, 3.7216715177745113`*^9, 3.721671993325136*^9, 
   3.721676861526475*^9, 3.7217248813360653`*^9, 3.722060181802537*^9, 
   3.7220648063207207`*^9, 3.722071795655725*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721565509580579*^9, 3.7215655267688313`*^9}, {
   3.721565563930847*^9, 3.721565615627986*^9}, {3.7215656537120743`*^9, 
   3.7215656675592527`*^9}, 3.721565725234832*^9, 3.721565799502618*^9, {
   3.721566041116291*^9, 3.72156608005135*^9}, 3.721566454743464*^9, 
   3.7215668684447117`*^9, 3.721567356954936*^9, 3.721631584794983*^9, 
   3.7216376664611464`*^9, 3.721639438118135*^9, 3.721644965209543*^9, 
   3.7216450977110043`*^9, 3.7216715177745113`*^9, 3.721671993325136*^9, 
   3.721676861526475*^9, 3.7217248813360653`*^9, 3.722060181802537*^9, 
   3.7220648063207207`*^9, 3.722071795656304*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721565509580579*^9, 3.7215655267688313`*^9}, {
   3.721565563930847*^9, 3.721565615627986*^9}, {3.7215656537120743`*^9, 
   3.7215656675592527`*^9}, 3.721565725234832*^9, 3.721565799502618*^9, {
   3.721566041116291*^9, 3.72156608005135*^9}, 3.721566454743464*^9, 
   3.7215668684447117`*^9, 3.721567356954936*^9, 3.721631584794983*^9, 
   3.7216376664611464`*^9, 3.721639438118135*^9, 3.721644965209543*^9, 
   3.7216450977110043`*^9, 3.7216715177745113`*^9, 3.721671993325136*^9, 
   3.721676861526475*^9, 3.7217248813360653`*^9, 3.722060181802537*^9, 
   3.7220648063207207`*^9, 3.722071795656664*^9}]
}, Open  ]],

Cell["\<\
This part becomes gauge invarriant once it is combined with diagrams \
involving tree or four wilson lines!, i.e. by adding those graphs one gets:
Todo:
=\
\>", "Text",
 CellChangeTimes->{{3.721565968715386*^9, 3.721566033702771*^9}, {
   3.72156608286633*^9, 3.7215660854732447`*^9}, 3.721566416534745*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Second line of D.40", "Subsubsection",
 CellChangeTimes->{{3.721564551831497*^9, 3.721564555871119*^9}, {
   3.721566144625101*^9, 3.721566146808756*^9}, 3.721568670155488*^9}],

Cell[TextData[{
 "This is obtained by factorising the term proportional to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "A"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.721566152710353*^9, 3.721566172257433*^9}}],

Cell["\<\
Axial gauge and Feynman gauge yield the same result since the result holds \
for arbitrary sw3.\
\>", "Text",
 CellChangeTimes->{{3.721566271723596*^9, 3.7215662920833693`*^9}, {
  3.721566969721759*^9, 3.721566971232596*^9}, {3.7215674524424047`*^9, 
  3.721567472666173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tij", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"Plus", "@@", "Kij2"}], ",", "CA"}], "]"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "+", 
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "ir_"], ",", 
          SubscriptBox["q", "ir_"]}], "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{"sw0", "\[Rule]", "1"}], ",", 
       RowBox[{"sw1", "\[Rule]", "1"}], ",", 
       RowBox[{"sw2", "\[RuleDelayed]", "1"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["T", "i"], "\[CenterDot]", 
        SubscriptBox["T", "j"]}], "\[Rule]", "1"}], ",", 
      RowBox[{
       SubscriptBox["C", "i"], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       SubscriptBox["C", "j"], "\[Rule]", 
       RowBox[{"-", "1"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721412873670395*^9, 3.721412885013754*^9}, {
  3.7214130158232403`*^9, 3.72141303397386*^9}, {3.721413098928068*^9, 
  3.721413101737132*^9}, {3.721413637000098*^9, 3.721413684417243*^9}, {
  3.7214144229659967`*^9, 3.7214144281661797`*^9}, {3.7214723576917467`*^9, 
  3.721472380330524*^9}, {3.721472485965026*^9, 3.7214724938678617`*^9}, {
  3.721566191487109*^9, 3.7215662467162848`*^9}, {3.721566284707333*^9, 
  3.721566285339601*^9}, {3.7215667536195917`*^9, 3.721566763380252*^9}, {
  3.721567330120015*^9, 3.721567334104175*^9}, {3.721567365674068*^9, 
  3.7215673791933107`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tij", "-", 
   RowBox[{"STotal", "[", 
    RowBox[{"i", ",", "j"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.721465576754342*^9, 3.7214655871923447`*^9}, {
  3.721472367578369*^9, 3.72147238577042*^9}, {3.721566466856328*^9, 
  3.721566491023872*^9}, {3.721566655632223*^9, 3.721566702521923*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.721465587651226*^9, {3.721472082335683*^9, 3.721472112153247*^9}, 
   3.7214723338396473`*^9, {3.721472372189583*^9, 3.721472386283319*^9}, 
   3.721472849781995*^9, 3.721472943562307*^9, 3.721566307396091*^9, 
   3.7215664250239897`*^9, 3.721566458228634*^9, {3.721566488598413*^9, 
   3.721566491294693*^9}, {3.721566651817404*^9, 3.721566672232332*^9}, 
   3.7215667043597307`*^9, 3.72156676737191*^9, 3.721566870886566*^9, {
   3.721567357925591*^9, 3.721567383022369*^9}, {3.721569557993208*^9, 
   3.721569559882764*^9}, 3.721631586849473*^9, 3.72163766840757*^9, 
   3.721639440056466*^9, 3.7216449721383867`*^9, 3.721645099855447*^9, 
   3.721671520731254*^9, 3.7216719953335667`*^9, 3.721676863887723*^9, 
   3.721724883269816*^9, 3.722060183042199*^9, 3.7220648076497927`*^9, 
   3.722071796772355*^9}]
}, Open  ]],

Cell["\<\
Also note that the result is independent of sw2! i.e. there is not net \
dependence on the gauge vertors!\
\>", "Text",
 CellChangeTimes->{{3.721569094816753*^9, 3.7215691182487803`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Ghost Feynman rule", "Subsubsection",
 CellChangeTimes->{{3.721561692525393*^9, 3.721561713910047*^9}, {
   3.721567878067986*^9, 3.721567881267003*^9}, {3.721568512303466*^9, 
   3.721568524790701*^9}, {3.721633905513411*^9, 3.721633937851006*^9}, {
   3.721634938181225*^9, 3.721634945412129*^9}, 3.7216618918766212`*^9}],

Cell["Ghost rule connecting i j:", "Text",
 CellChangeTimes->{{3.7215625229208393`*^9, 3.721562528704282*^9}, {
  3.7215625696489162`*^9, 3.721562598521695*^9}, {3.721567909724477*^9, 
  3.721567914227517*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ghost", "[", 
   RowBox[{"j_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReadableNotation", "[", 
     RowBox[{"ColourSimplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"j", ",", "d1"}], "]"}], ",", 
        RowBox[{"Tq", "[", 
         RowBox[{"d1", ",", 
          SubscriptBox["a", "2"], ",", 
          SubscriptBox["a", "1"]}], "]"}], ",", 
        RowBox[{"Tq", "[", 
         RowBox[{
          SubscriptBox["a", "1"], ",", 
          SubscriptBox["a", "2"], ",", "d2"}], "]"}], ",", 
        RowBox[{"T", "[", 
         RowBox[{"i", ",", "d2"}], "]"}]}], "}"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "*", 
   SuperscriptBox["sw0", "2"], "*", 
   RowBox[{"Ct", "[", 
    RowBox[{
     RowBox[{"(", " ", 
      FractionBox[
       RowBox[{"fv", "[", 
        RowBox[{
         SubscriptBox["p", "j"], ",", "\[Beta]"}], "]"}], 
       RowBox[{"2", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], "]"}]}]], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", "\[Beta]"}], "]"}], 
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["q", "2"], ",", "\[Alpha]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["q", "2"], ",", "\[Beta]"}], "]"}], 
        RowBox[{"fv", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", "\[Alpha]"}], "]"}]}]}], ")"}], 
     RowBox[{"(", " ", 
      FractionBox[
       RowBox[{"fv", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", "\[Alpha]"}], "]"}], 
       RowBox[{"2", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], "]"}]}]], ")"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.721307831554398*^9, 3.721307834251306*^9}, {
   3.721307953482177*^9, 3.721307955024926*^9}, {3.721307992075275*^9, 
   3.721308213038094*^9}, {3.721308247999789*^9, 3.721308324882779*^9}, {
   3.7213100822955837`*^9, 3.721310088662075*^9}, {3.721310309673073*^9, 
   3.721310389727487*^9}, {3.72141351093826*^9, 3.721413533694276*^9}, {
   3.72141387701679*^9, 3.721413940843006*^9}, {3.7214141409744062`*^9, 
   3.7214141451410637`*^9}, {3.721414763400425*^9, 3.7214147672146797`*^9}, {
   3.721416091488721*^9, 3.7214160925746613`*^9}, {3.721562694397881*^9, 
   3.721562709413011*^9}, 3.7215670128631687`*^9, {3.721567061336205*^9, 
   3.721567147878908*^9}, {3.721567186657743*^9, 3.721567248842325*^9}, {
   3.721567322503806*^9, 3.7215673230398827`*^9}, {3.721567964623439*^9, 
   3.721568059751433*^9}, {3.721568296890024*^9, 3.721568413303108*^9}, {
   3.721568859496936*^9, 3.721568865103148*^9}, {3.721569637942852*^9, 
   3.721569640188919*^9}, {3.721631600316897*^9, 3.721631604675235*^9}, {
   3.721634815746951*^9, 3.721634824430377*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ghost", "[", 
  RowBox[{"j", ",", "i"}], "]"}]], "Input",
 CellChangeTimes->{{3.721568870325859*^9, 3.7215688710379143`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"CA", " ", 
   SuperscriptBox["sw0", "2"], " ", 
   RowBox[{
    SubscriptBox["T", "i"], "\[CenterDot]", 
    SubscriptBox["T", "j"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], ")"}], "2"], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], ")"}], "2"], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.7215688713304033`*^9, 3.7215696423890753`*^9, 
  3.721631586993513*^9, 3.7216336878489428`*^9, 3.7216348279539757`*^9, 
  3.721637668495886*^9, 3.721639440149466*^9, 3.721644972336071*^9, 
  3.72164509995399*^9, 3.721671520854414*^9, 3.7216719954546347`*^9, 
  3.721676863988822*^9, 3.721724883396286*^9, 3.722060183109436*^9, 
  3.722064808057366*^9, 3.72207179682957*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ghostij2", "=", 
  RowBox[{
   RowBox[{"Ghost", "[", 
    RowBox[{"j", ",", "i"}], "]"}], "+", 
   RowBox[{"Ghost", "[", 
    RowBox[{"i", ",", "j"}], "]"}], "+", 
   RowBox[{"Ghost", "[", 
    RowBox[{"i", ",", "i"}], "]"}], "+", 
   RowBox[{"Ghost", "[", 
    RowBox[{"j", ",", "j"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.721568794069344*^9, 3.721568796260172*^9}, {
  3.7216449177059717`*^9, 3.72164493839189*^9}, {3.721645480119705*^9, 
  3.7216454840257397`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"CA", " ", 
     SuperscriptBox["sw0", "2"], " ", 
     SubscriptBox["C", "i"], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], "+", 
   FractionBox[
    RowBox[{"CA", " ", 
     SuperscriptBox["sw0", "2"], " ", 
     SubscriptBox["C", "j"], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], "+", 
   RowBox[{"2", " ", "CA", " ", 
    SuperscriptBox["sw0", "2"], " ", 
    RowBox[{
     SubscriptBox["T", "i"], "\[CenterDot]", 
     SubscriptBox["T", "j"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "2"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "1"]}], ")"}]}], 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"sp", "(", 
          RowBox[{
           SubscriptBox["q", "1"], ",", 
           SubscriptBox["q", "2"]}], ")"}], "2"], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["q", "1"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["q", "2"]}], ")"}]}], 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"sp", "(", 
          RowBox[{
           SubscriptBox["q", "1"], ",", 
           SubscriptBox["q", "2"]}], ")"}], "2"], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}]}]]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.721645484346464*^9, 3.721671520908173*^9, 
  3.721671995486211*^9, 3.721676864019959*^9, 3.721724883451034*^9, 
  3.72206018315143*^9, 3.722064808219385*^9, 3.722071796878681*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
In the Feynman gauge, physical polarisation can be trade off by ghosts\
\>", "Subsubsection",
 CellChangeTimes->{{3.721561692525393*^9, 3.721561713910047*^9}, {
  3.721567878067986*^9, 3.721567881267003*^9}, {3.721568512303466*^9, 
  3.721568524790701*^9}, {3.721633905513411*^9, 3.721633937851006*^9}, {
  3.721661894980681*^9, 3.7216619070423117`*^9}}],

Cell["Feynman Gauge approach with ghost:", "Text",
 CellChangeTimes->{{3.721567487637598*^9, 3.721567496037141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TijWithGhost", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Plus", "@@", "Kij2"}], ")"}], "+", "Ghostij2"}], ",", 
           "CA"}], "]"}], ")"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a", ",", "b"}], "]"}], "+", 
          RowBox[{"sp", "[", 
           RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["q", "ir_"], ",", 
           SubscriptBox["q", "ir_"]}], "]"}], "\[Rule]", "0"}], ",", 
        RowBox[{"sw1", "\[Rule]", "sw1"}], ",", 
        RowBox[{"sw2", "\[Rule]", "0"}], ",", 
        RowBox[{"sw3", "\[Rule]", "0"}]}], "}"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["T", "i"], "\[CenterDot]", 
        SubscriptBox["T", "j"]}], "\[Rule]", "1"}], ",", 
      RowBox[{
       SubscriptBox["C", "i"], "\[Rule]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       SubscriptBox["C", "j"], "\[Rule]", 
       RowBox[{"-", "1"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721568982282179*^9, 3.721569079509142*^9}, {
  3.721569395112479*^9, 3.721569434913287*^9}, {3.721569486247671*^9, 
  3.721569491977438*^9}, {3.7215695744755383`*^9, 3.721569581987259*^9}, {
  3.721569684586678*^9, 3.7215696880247583`*^9}, {3.7215697358705063`*^9, 
  3.7215697363882837`*^9}}],

Cell["Finally we can show that :", "Text",
 CellChangeTimes->{{3.721634973205264*^9, 3.721634984621868*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TijWithGhost", "-", 
     RowBox[{"STotal", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], "/.", 
    RowBox[{"sw1", "\[Rule]", "1"}]}], "/.", 
   RowBox[{"sw0", "\[Rule]", "1"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{
  3.721569519729496*^9, {3.721569695867132*^9, 3.721569739260275*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.7215695206399927`*^9, 3.7215695844112186`*^9, {3.721569649834437*^9, 
   3.7215696558319263`*^9}, {3.7215697152472486`*^9, 3.721569743513125*^9}, 
   3.721631587440243*^9, 3.7216316457090063`*^9, 3.721633688303423*^9, 
   3.721634828577395*^9, 3.7216349563208437`*^9, 3.72163766895433*^9, 
   3.721639041402217*^9, 3.721639440601779*^9, {3.721644882164949*^9, 
   3.721644893377425*^9}, {3.721644945941792*^9, 3.7216449733307667`*^9}, 
   3.721645100428488*^9, 3.721671521408641*^9, 3.7216719959151917`*^9, 
   3.7216768645123367`*^9, 3.721724883889923*^9, 3.722060183408025*^9, 
   3.722064808569579*^9, 3.722071797144327*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Extracting all graphs that do not have bubble structure", \
"Subsubsection",
 CellChangeTimes->{{3.721561692525393*^9, 3.721561713910047*^9}, {
  3.721567878067986*^9, 3.721567881267003*^9}, {3.721568512303466*^9, 
  3.721568524790701*^9}, {3.721633905513411*^9, 3.721633937851006*^9}, {
  3.7216349914151278`*^9, 3.7216349990544252`*^9}, {3.721637760110393*^9, 
  3.721637770013399*^9}}],

Cell["\<\
First we remove the gluon self energy (including its ghost contribution)\
\>", "Text",
 CellChangeTimes->{{3.721635007920154*^9, 3.7216350378974752`*^9}}],

Cell["Ct[0] =  gluon bubble + ghost", "Text",
 CellChangeTimes->{{3.7216389652646923`*^9, 3.721638979648842*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"TijWithGhost", ",", 
      SuperscriptBox["sw0", "2"]}], "]"}], 
    SuperscriptBox["sw0", "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721638956134663*^9, 3.721638994794717*^9}, 
   3.721639263820815*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TijWithGhostWithoutGBlubble", "=", 
   RowBox[{
    RowBox[{"TijWithGhost", "-", 
     RowBox[{"Ctr", "[", "0", "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"TijWithGhostWithoutGBlubble", ",", "i", ",", "j"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"TijWithGhostWithoutGBlubble", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Coefficient", "[", 
  RowBox[{"TijWithGhostWithoutGBlubble", ",", 
   SuperscriptBox["sw0", "2"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.721631959066147*^9, 3.721631959449127*^9}, 
   3.721632899804775*^9, {3.721635040249802*^9, 3.721635061098647*^9}, {
   3.7216384843814487`*^9, 3.721638530406591*^9}, 3.7216390065553617`*^9, {
   3.721639072383584*^9, 3.721639074927054*^9}, 3.721639602083872*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721635056550161*^9, 3.7216350617184267`*^9}, 
   3.7216376694515467`*^9, 3.72163773192102*^9, {3.721638497875445*^9, 
   3.7216385310258207`*^9}, 3.721638561851303*^9, 3.721639012330695*^9, 
   3.721639062273547*^9, 3.721639099252722*^9, 3.721639441241219*^9, {
   3.721639597025425*^9, 3.721639602992392*^9}, 3.721644975067801*^9, 
   3.721645100928192*^9, 3.7216715219989033`*^9, 3.721671996395545*^9, 
   3.7216768651700907`*^9, 3.7217248843876143`*^9, 3.7220601836869707`*^9, 
   3.7220648089036093`*^9, 3.722071797442698*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721635056550161*^9, 3.7216350617184267`*^9}, 
   3.7216376694515467`*^9, 3.72163773192102*^9, {3.721638497875445*^9, 
   3.7216385310258207`*^9}, 3.721638561851303*^9, 3.721639012330695*^9, 
   3.721639062273547*^9, 3.721639099252722*^9, 3.721639441241219*^9, {
   3.721639597025425*^9, 3.721639602992392*^9}, 3.721644975067801*^9, 
   3.721645100928192*^9, 3.7216715219989033`*^9, 3.721671996395545*^9, 
   3.7216768651700907`*^9, 3.7217248843876143`*^9, 3.7220601836869707`*^9, 
   3.7220648089036093`*^9, 3.722071797444746*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721635056550161*^9, 3.7216350617184267`*^9}, 
   3.7216376694515467`*^9, 3.72163773192102*^9, {3.721638497875445*^9, 
   3.7216385310258207`*^9}, 3.721638561851303*^9, 3.721639012330695*^9, 
   3.721639062273547*^9, 3.721639099252722*^9, 3.721639441241219*^9, {
   3.721639597025425*^9, 3.721639602992392*^9}, 3.721644975067801*^9, 
   3.721645100928192*^9, 3.7216715219989033`*^9, 3.721671996395545*^9, 
   3.7216768651700907`*^9, 3.7217248843876143`*^9, 3.7220601836869707`*^9, 
   3.7220648089036093`*^9, 3.722071797465775*^9}]
}, Open  ]],

Cell[TextData[{
 "Contributions proportional to sw1, depend only on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "+", 
    SubscriptBox["q", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " , and can be evaluated analytically using the results for the Bubble"
}], "Text",
 CellChangeTimes->{{3.721635081108477*^9, 3.72163515442316*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{"TijWithGhostWithoutGBlubble", ",", "sw1", ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7216351847046623`*^9, 3.7216351863674517`*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{3.721635187298091*^9, 3.721637669671344*^9, 
  3.721637731969108*^9, 3.721639441342802*^9, 3.721639609933483*^9, 
  3.721644975305292*^9, 3.7216451010676937`*^9, 3.721671522117794*^9, 
  3.7216719965399446`*^9, 3.721676865267736*^9, 3.721724884490327*^9, 
  3.722060183710238*^9, 3.7220648089359426`*^9, 3.7220717974913073`*^9}]
}, Open  ]],

Cell["\<\
Ct[1] =  contribution with the same structure as bubble without numerator, \
like an scalar bubble\
\>", "Text",
 CellChangeTimes->{{3.7216389652646923`*^9, 3.721638979648842*^9}, {
  3.7216391111196947`*^9, 3.721639130976123*^9}, {3.721639941059087*^9, 
  3.7216399622983828`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"TijWithGhostWithoutGBlubble", ",", "sw1"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"sw0", "\[Rule]", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarBubble", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"Ctr", "[", "1", "]"}], ",", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["p", "i"]}], "]"}]}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], "]"}]}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"Ctr", "[", "1", "]"}], ",", 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "j"], ",", 
            SubscriptBox["p", "j"]}], "]"}]}], "]"}], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["p", "j"]}], "]"}]}], "//", "Simplify"}], ")"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"Ctr", "[", "1", "]"}], ",", 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "i"], ",", 
            SubscriptBox["p", "j"]}], "]"}]}], "]"}], "//", "Simplify"}], 
       ")"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "j"]}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "1", "]"}], "-", "ScalarBubble"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.721631969049658*^9, 3.721632133131568*^9}, {
   3.721632202086569*^9, 3.721632316859982*^9}, {3.721635191072163*^9, 
   3.721635263252569*^9}, 3.7216376810734863`*^9, {3.72163913638862*^9, 
   3.721639155389585*^9}, {3.721639270567707*^9, 3.7216392914584513`*^9}, {
   3.721639645306645*^9, 3.721639667905602*^9}, {3.721639925260375*^9, 
   3.721639935804964*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.7216319645829144`*^9, 3.721632079289895*^9}, {
   3.721632111310367*^9, 3.721632133609932*^9}, {3.7216322144197063`*^9, 
   3.721632317663706*^9}, 3.721633688637825*^9, 3.7216348297839947`*^9, {
   3.7216351691213427`*^9, 3.721635199078329*^9}, {3.72163526445793*^9, 
   3.721635267675047*^9}, {3.721637669754442*^9, 3.721637681752082*^9}, 
   3.721637732015635*^9, {3.7216391656993437`*^9, 3.721639167189949*^9}, {
   3.7216392778720512`*^9, 3.7216392932055483`*^9}, 3.7216394413887*^9, {
   3.721639612147215*^9, 3.7216396683426123`*^9}, {3.7216399365429287`*^9, 
   3.72163996444452*^9}, 3.721644975407642*^9, 3.7216451011219997`*^9, 
   3.721671522172529*^9, 3.721671996594494*^9, 3.721676865326111*^9, 
   3.721724884535151*^9, 3.7220601837294083`*^9, 3.7220648089512997`*^9, 
   3.722071797517683*^9}]
}, Open  ]],

Cell["\<\
NonBubbleLike = S_ijtotal - C[0]- C[1] ,  i.e. all the graphs that we CANNOT \
evaluate analytically\
\>", "Text",
 CellChangeTimes->{{3.7216389652646923`*^9, 3.721638979648842*^9}, {
  3.7216391111196947`*^9, 3.721639130976123*^9}, {3.7216391754072447`*^9, 
  3.721639231348928*^9}, {3.721639297065781*^9, 3.721639297529961*^9}, {
  3.7216398225028963`*^9, 3.721639829426867*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonBubbleLike", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TijWithGhost", "-", 
        RowBox[{"Ctr", "[", "1", "]"}], "-", 
        RowBox[{"Ctr", "[", "0", "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sw1", "\[Rule]", "1"}], ",", 
         RowBox[{"sw0", "\[Rule]", "1"}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], "+", 
         RowBox[{"sp", "[", 
          RowBox[{"a_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"sp", "[", 
         RowBox[{"a", ",", 
          RowBox[{"b", "+", "c"}]}], "]"}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"f_", " ", 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"b_", "+", "c_"}]}], "]"}], "/", "d_"}]}], ":>", 
       RowBox[{
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", "b"}], "]"}], 
         RowBox[{"f", "/", "d"}]}], "+", 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", "c"}], "]"}], 
         RowBox[{"f", "/", "d"}]}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72163297470787*^9, 3.7216330387264977`*^9}, {
   3.721633950076625*^9, 3.72163395637255*^9}, 3.721634449137824*^9, {
   3.7216354043483667`*^9, 3.721635416677932*^9}, 3.721637748792431*^9, {
   3.7216392350135612`*^9, 3.7216392407417383`*^9}, {3.721639299121999*^9, 
   3.721639305674354*^9}, {3.7216393432994432`*^9, 3.7216393557363033`*^9}, {
   3.721639798429172*^9, 3.721639811474555*^9}, {3.7216464734758987`*^9, 
   3.721646489932949*^9}, {3.721646578069564*^9, 3.721646632884897*^9}, 
   3.721646677906839*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"NonBubbleLike", ",", "i", ",", "j"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"NonBubbleLike", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.721638321631197*^9, 3.721638369749716*^9}, {
  3.721638567642476*^9, 3.721638595951715*^9}, {3.7216393621397333`*^9, 
  3.7216393638277082`*^9}, {3.721639818109721*^9, 3.721639820509562*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721638332180402*^9, 3.721638370266161*^9}, {
   3.721638586479443*^9, 3.721638596582597*^9}, 3.721639364313773*^9, 
   3.721639441717634*^9, 3.7216396727930307`*^9, 3.721639835796694*^9, 
   3.721644976249188*^9, 3.721645101449216*^9, 3.721646635287043*^9, 
   3.7216466817833014`*^9, 3.721671522617605*^9, 3.721671996964213*^9, 
   3.721676865856469*^9, 3.721724884909997*^9, 3.722060183944704*^9, 
   3.722064809177513*^9, 3.722071797735354*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721638332180402*^9, 3.721638370266161*^9}, {
   3.721638586479443*^9, 3.721638596582597*^9}, 3.721639364313773*^9, 
   3.721639441717634*^9, 3.7216396727930307`*^9, 3.721639835796694*^9, 
   3.721644976249188*^9, 3.721645101449216*^9, 3.721646635287043*^9, 
   3.7216466817833014`*^9, 3.721671522617605*^9, 3.721671996964213*^9, 
   3.721676865856469*^9, 3.721724884909997*^9, 3.722060183944704*^9, 
   3.722064809177513*^9, 3.722071797738357*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Extracting other contributions", "Subsubsection",
 CellChangeTimes->{{3.721633959605832*^9, 3.721633969453301*^9}, {
  3.721661913597012*^9, 3.721661918898975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KinSimplify", "[", "in_", "]"}], ":=", 
  RowBox[{
   RowBox[{"in", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "+", 
       RowBox[{"sp", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.721647019581641*^9, 3.7216470462875843`*^9}, {
  3.721651516442192*^9, 3.7216515254349194`*^9}}],

Cell["\<\
In this section we now need to organise Ctr[2] in a non-complicated maner\
\>", "Text",
 CellChangeTimes->{{3.721639390346148*^9, 3.721639421177738*^9}, {
  3.7216619480699987`*^9, 3.7216619637003193`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ctr", "[", "2", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"NonBubbleLike", ",", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], "]"}], ",", "2"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], "]"}], ")"}], "2"]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ctr", "[", "3", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"NonBubbleLike", ",", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], "]"}], ",", "2"}], "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], "]"}], ")"}], "2"]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7216352996927443`*^9, 3.721635313644945*^9}, {
  3.721635350714821*^9, 3.7216353742052507`*^9}, {3.721639840659905*^9, 
  3.72163989224571*^9}, {3.721645799416226*^9, 3.721645801135964*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], "2"], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.721635354794445*^9, 3.721635374586347*^9}, 
   3.721635419708476*^9, {3.721637669946137*^9, 3.721637687678212*^9}, {
   3.7216377259301023`*^9, 3.721637774529483*^9}, 3.721638683627788*^9, 
   3.7216393686870337`*^9, 3.721639441801178*^9, 3.721639675099638*^9, 
   3.721639893119289*^9, 3.721639969738865*^9, 3.721640008292245*^9, 
   3.721644976390608*^9, 3.721645101505945*^9, 3.721645507985117*^9, 
   3.721645756008727*^9, 3.721645802474071*^9, 3.7216466373739977`*^9, 
   3.7216466936886387`*^9, 3.721647247578017*^9, 3.721650807182207*^9, 
   3.721651267711678*^9, 3.721652268476122*^9, 3.7216523375284567`*^9, 
   3.721671522701797*^9, 3.7216715665777197`*^9, 3.721671997036237*^9, 
   3.721676865938572*^9, 3.721724884997158*^9, 3.722060183972753*^9, 
   3.72206480921071*^9, 3.722071797772572*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}], "2"], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.721635354794445*^9, 3.721635374586347*^9}, 
   3.721635419708476*^9, {3.721637669946137*^9, 3.721637687678212*^9}, {
   3.7216377259301023`*^9, 3.721637774529483*^9}, 3.721638683627788*^9, 
   3.7216393686870337`*^9, 3.721639441801178*^9, 3.721639675099638*^9, 
   3.721639893119289*^9, 3.721639969738865*^9, 3.721640008292245*^9, 
   3.721644976390608*^9, 3.721645101505945*^9, 3.721645507985117*^9, 
   3.721645756008727*^9, 3.721645802474071*^9, 3.7216466373739977`*^9, 
   3.7216466936886387`*^9, 3.721647247578017*^9, 3.721650807182207*^9, 
   3.721651267711678*^9, 3.721652268476122*^9, 3.7216523375284567`*^9, 
   3.721671522701797*^9, 3.7216715665777197`*^9, 3.721671997036237*^9, 
   3.721676865938572*^9, 3.721724884997158*^9, 3.722060183972753*^9, 
   3.72206480921071*^9, 3.72207179777588*^9}]
}, Open  ]],

Cell["Other contributions without a tripple gluon vertex", "Text",
 CellChangeTimes->{{3.7216354350054617`*^9, 3.721635457414524*^9}, {
  3.721640104854082*^9, 3.721640117678088*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NonTripple", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NonBubbleLike", "-", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"NonBubbleLike", ",", 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], "/", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}], "-", 
       RowBox[{"Ctr", "[", "2", "]"}], "-", 
       RowBox[{"Ctr", "[", "3", "]"}]}], "//", "FullSimplify"}], ")"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossCheckS", "[", 
   RowBox[{"NonTripple", ",", "i", ",", "j"}], "]"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.721635464470625*^9, 3.7216356967916393`*^9}, {
   3.7216357360642853`*^9, 3.7216357376001463`*^9}, {3.721635810803357*^9, 
   3.721635815866354*^9}, {3.7216380484374523`*^9, 3.721638048701441*^9}, {
   3.72163864020487*^9, 3.721638723857654*^9}, 3.7216399086499662`*^9, {
   3.721640126088456*^9, 3.7216402157945967`*^9}, {3.721640277109263*^9, 
   3.721640348068077*^9}, {3.721640396227461*^9, 3.721640432670669*^9}, {
   3.721641492665956*^9, 3.721641501402233*^9}, {3.721641554243412*^9, 
   3.721641554827283*^9}, {3.721645722608404*^9, 3.7216457914917583`*^9}, {
   3.7216463903009367`*^9, 3.721646392729436*^9}, 3.721646673661764*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721645746151598*^9, 3.721645804116893*^9}, 
   3.721646344515877*^9, 3.721646393130466*^9, 3.721646639942136*^9, 
   3.7216466987923937`*^9, 3.721647078262789*^9, 3.721647247654859*^9, 
   3.72165080724762*^9, 3.721651267794509*^9, 3.721652268559903*^9, 
   3.721652337612917*^9, 3.721671522920577*^9, 3.721671566765915*^9, 
   3.72167199725449*^9, 3.721676866178565*^9, 3.721724885213664*^9, 
   3.7220601841530323`*^9, 3.722064809336034*^9, 3.72207179791881*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PartialFractioing", "=", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"f_", " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        SubscriptBox["q", "s_"]}], "]"}]}], 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        SubscriptBox["q", "r_"]}], "]"}], " ", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        RowBox[{
         SubscriptBox["q", "r_"], "+", 
         SubscriptBox["q", "s_"]}]}], "]"}], "g_"}]], ":>", 
    RowBox[{
     FractionBox[
      RowBox[{"f", " "}], 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "t"], ",", 
         SubscriptBox["q", "r"]}], "]"}], "g"}]], "-", 
     FractionBox[
      RowBox[{"f", " "}], 
      RowBox[{
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "t"], ",", 
         RowBox[{
          SubscriptBox["q", "r"], "+", 
          SubscriptBox["q", "s"]}]}], "]"}], "g"}]]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.721640599973024*^9, 3.721640603248678*^9}, {
   3.7216406555490026`*^9, 3.721640659389052*^9}, {3.7216412395961437`*^9, 
   3.721641313150508*^9}, {3.721641372716187*^9, 3.7216414188535767`*^9}, {
   3.721641604879191*^9, 3.721641622071864*^9}, {3.721641849500605*^9, 
   3.721641944737688*^9}, {3.721642019607716*^9, 3.7216421077549047`*^9}, 
   3.721645537550253*^9, {3.721645586521028*^9, 3.721645603871573*^9}, 
   3.7216463706506453`*^9, {3.721650787041033*^9, 3.7216507947753*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"f_", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        SubscriptBox["q", "s_"]}], ")"}]}], 
     RowBox[{"g_", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        SubscriptBox["q", "r_"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        RowBox[{
         SubscriptBox["q", "r_"], "+", 
         SubscriptBox["q", "s_"]}]}], ")"}]}]], "\[RuleDelayed]", 
    RowBox[{
     FractionBox["f", 
      RowBox[{"g", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "t"], ",", 
         SubscriptBox["q", "r"]}], ")"}]}]], "-", 
     FractionBox["f", 
      RowBox[{"g", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "t"], ",", 
         RowBox[{
          SubscriptBox["q", "r"], "+", 
          SubscriptBox["q", "s"]}]}], ")"}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.721642109733096*^9, 3.721644977517107*^9, 3.721645102168447*^9, 
   3.721645512527103*^9, 3.7216456200618467`*^9, 3.7216463793841047`*^9, 
   3.7216466423131037`*^9, 3.72164670024471*^9, 3.721646843177779*^9, 
   3.721647247717379*^9, {3.721650795425056*^9, 3.721650807311284*^9}, 
   3.7216512678631353`*^9, 3.721652268626129*^9, 3.7216523376753187`*^9, 
   3.721671522972858*^9, 3.7216715667953863`*^9, 3.721671997294442*^9, 
   3.721676866227537*^9, 3.721724885269349*^9, 3.722060184199966*^9, 
   3.72206480935406*^9, 3.722071797987541*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"NonTripple", ",", 
            RowBox[{"sp", "[", 
             RowBox[{
              SubscriptBox["p", "i"], ",", 
              SubscriptBox["p", "j"]}], "]"}], ",", "2"}], "]"}], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             SubscriptBox["p", "j"]}], "]"}], "2"]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"NonTripple", ",", 
            RowBox[{"sp", "[", 
             RowBox[{
              SubscriptBox["p", "i"], ",", 
              SubscriptBox["p", "j"]}], "]"}], ",", "1"}], "]"}], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "i"], ",", 
            SubscriptBox["p", "j"]}], "]"}]}], ")"}]}], "//", "Simplify"}], "//",
       "Expand"}], ")"}], "//.", "PartialFractioing"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7216404601366453`*^9, 3.721640468625758*^9}, {
  3.721640575046214*^9, 3.72164059863267*^9}, {3.721641433040166*^9, 
  3.721641473177062*^9}, {3.721641508189294*^9, 3.721641577781891*^9}, {
  3.7216456361780987`*^9, 3.7216456504328547`*^9}, {3.7216464036122227`*^9, 
  3.72164642159429*^9}, {3.721646705274353*^9, 3.721646718299439*^9}, {
  3.721646855181031*^9, 3.7216468962872677`*^9}, {3.7216471706730633`*^9, 
  3.7216471787346783`*^9}, {3.721652213772057*^9, 3.721652263004973*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CrossCheckS", "[", 
  RowBox[{
   RowBox[{"Ctr", "[", "4", "]"}], ",", "i", ",", "j"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{
   RowBox[{"Ctr", "[", "4", "]"}], ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.721646898629027*^9, 3.721646922933085*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721646911479567*^9, 3.721646923284561*^9}, 
   3.721647181548964*^9, 3.7216472477896767`*^9, 3.721650807387892*^9, 
   3.721651267933666*^9, 3.721652268689262*^9, 3.721652337753293*^9, 
   3.7216715231158037`*^9, 3.721671566865025*^9, 3.721671997356189*^9, 
   3.721676866461495*^9, 3.72172488533888*^9, 3.722060184264512*^9, 
   3.7220648093911953`*^9, 3.7220717980216703`*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721646911479567*^9, 3.721646923284561*^9}, 
   3.721647181548964*^9, 3.7216472477896767`*^9, 3.721650807387892*^9, 
   3.721651267933666*^9, 3.721652268689262*^9, 3.721652337753293*^9, 
   3.7216715231158037`*^9, 3.721671566865025*^9, 3.721671997356189*^9, 
   3.721676866461495*^9, 3.72172488533888*^9, 3.722060184264512*^9, 
   3.7220648093911953`*^9, 3.7220717980221357`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "4", "]"}], "-", "NonTripple"}], "//", 
  "KinSimplify"}]], "Input",
 CellChangeTimes->{{3.7216469443803864`*^9, 3.721646970253183*^9}, {
  3.7216470519750233`*^9, 3.7216470532401114`*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.72164696473799*^9, 3.721646971390139*^9}, 
   3.7216470537021313`*^9, 3.721647183290168*^9, 3.721647247861763*^9, 
   3.7216508074630632`*^9, 3.721651268009644*^9, 3.7216522687753353`*^9, 
   3.721652337825202*^9, 3.7216715231736517`*^9, 3.721671566916594*^9, 
   3.721671997408639*^9, 3.721676866510829*^9, 3.721724885402114*^9, 
   3.72206018427901*^9, 3.722064809400629*^9, 3.722071798024891*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"WithTripple", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"NonBubbleLike", ",", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "/", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], "]"}]}], "//", "Expand"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"WithTripple", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"WithTripple", ",", "i", ",", "j"}], "]"}]}], "Input",
 CellChangeTimes->{{3.721647213534745*^9, 3.721647293863523*^9}, {
  3.721647337392995*^9, 3.721647360418579*^9}, {3.721647396129952*^9, 
  3.721647402338966*^9}, {3.721647530525576*^9, 3.721647558029725*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721647540691214*^9, 3.7216475585452423`*^9}, 
   3.721650807532373*^9, 3.7216512681092653`*^9, 3.721652268844789*^9, 
   3.721652337896709*^9, 3.721671523222917*^9, 3.721671566966202*^9, 
   3.721671997462248*^9, 3.7216768665607567`*^9, 3.721724885452146*^9, 
   3.722060184297394*^9, 3.7220648094125757`*^9, 3.722071798055025*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721647540691214*^9, 3.7216475585452423`*^9}, 
   3.721650807532373*^9, 3.7216512681092653`*^9, 3.721652268844789*^9, 
   3.721652337896709*^9, 3.721671523222917*^9, 3.721671566966202*^9, 
   3.721671997462248*^9, 3.7216768665607567`*^9, 3.721724885452146*^9, 
   3.722060184297394*^9, 3.7220648094125757`*^9, 3.7220717980556183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"WithTripple", ",", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], "]"}], ",", "1"}], "]"}], "//.", 
   "PartialFractioing"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"%", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"WithTripple", ",", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], "]"}], ",", "1"}], "]"}], "//.", 
   "PartialFractioing"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"%", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"WithTripple", ",", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], "]"}], ",", "1"}], "]"}], "//.", 
   "PartialFractioing"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrossCheckS", "[", 
  RowBox[{"%", ",", 
   SubscriptBox["q", "1"], ",", 
   SubscriptBox["q", "2"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7216474075143423`*^9, 3.721647442628747*^9}, {
  3.721647477799423*^9, 3.721647487190089*^9}, {3.7216475230286703`*^9, 
  3.7216475288450108`*^9}, {3.721647579973813*^9, 3.7216476723166637`*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721647405577888*^9, 3.7216474429349537`*^9}, {
   3.7216474793536367`*^9, 3.721647487671925*^9}, {3.7216475903056717`*^9, 
   3.7216476319647427`*^9}, {3.721647669956889*^9, 3.7216476727176437`*^9}, 
   3.7216508076167297`*^9, 3.7216512681925707`*^9, 3.7216513439976273`*^9, 
   3.721652268928424*^9, 3.7216523379806347`*^9, 3.721671523290374*^9, 
   3.721671567017254*^9, 3.721671997579537*^9, 3.7216768666103783`*^9, 
   3.7217248855801992`*^9, 3.722060184322555*^9, 3.722064809424283*^9, 
   3.7220717980848417`*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721647405577888*^9, 3.7216474429349537`*^9}, {
   3.7216474793536367`*^9, 3.721647487671925*^9}, {3.7216475903056717`*^9, 
   3.7216476319647427`*^9}, {3.721647669956889*^9, 3.7216476727176437`*^9}, 
   3.7216508076167297`*^9, 3.7216512681925707`*^9, 3.7216513439976273`*^9, 
   3.721652268928424*^9, 3.7216523379806347`*^9, 3.721671523290374*^9, 
   3.721671567017254*^9, 3.721671997579537*^9, 3.7216768666103783`*^9, 
   3.7217248855801992`*^9, 3.722060184322555*^9, 3.722064809424283*^9, 
   3.722071798086307*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721647405577888*^9, 3.7216474429349537`*^9}, {
   3.7216474793536367`*^9, 3.721647487671925*^9}, {3.7216475903056717`*^9, 
   3.7216476319647427`*^9}, {3.721647669956889*^9, 3.7216476727176437`*^9}, 
   3.7216508076167297`*^9, 3.7216512681925707`*^9, 3.7216513439976273`*^9, 
   3.721652268928424*^9, 3.7216523379806347`*^9, 3.721671523290374*^9, 
   3.721671567017254*^9, 3.721671997579537*^9, 3.7216768666103783`*^9, 
   3.7217248855801992`*^9, 3.722060184322555*^9, 3.722064809424283*^9, 
   3.722071798086956*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"WithTripple", ",", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], "]"}], ",", "1"}], "]"}], 
    RowBox[{"sp", "[", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "i"]}], "]"}]}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1_.", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"a2_.", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a1", "+", "a2"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "i"], ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "j"], ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "2"], 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["q", "1"], ",", 
           SubscriptBox["q", "2"]}], "]"}]}], ")"}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a1_.", "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], "2"], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a1", "//", "Simplify"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "//.", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "+", " ", 
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", " ", 
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", 
           RowBox[{"b", "+", "c"}]}], "]"}]}], "}"}]}], ")"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"WithTrippleii", "=", 
  RowBox[{"%", "//.", "PartialFractioing"}]}]}], "Input",
 CellChangeTimes->{{3.721650302796831*^9, 3.721650303268897*^9}, {
   3.721650409905304*^9, 3.721650486283428*^9}, {3.721650524596551*^9, 
   3.721650604709486*^9}, {3.721650863815769*^9, 3.721650867002974*^9}, 
   3.721651053269773*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "2"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}]}]]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "i"]}], ")"}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "i"]}], ")"}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}]}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.721650488017075*^9, {3.721650551642879*^9, 3.721650605105913*^9}, 
   3.721650807779407*^9, 3.721650870775958*^9, 3.721651072120349*^9, 
   3.7216511724313707`*^9, 3.72165126827378*^9, 3.721651345695272*^9, 
   3.721652269024304*^9, 3.72165233807545*^9, 3.721671523356284*^9, 
   3.721671567084013*^9, 3.721671997641905*^9, 3.7216768666778507`*^9, 
   3.7217248856525707`*^9, 3.72206018438211*^9, 3.7220648094778214`*^9, 
   3.7220717981285543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"WithTripple", ",", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], "]"}], ",", "1"}], "]"}], 
    RowBox[{"sp", "[", 
     RowBox[{
      SubscriptBox["p", "j"], ",", 
      SubscriptBox["p", "j"]}], "]"}]}], "//", "Expand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1_.", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"a2_.", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a1", "+", "a2"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "i"], ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "j"], ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "2"], 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["q", "1"], ",", 
           SubscriptBox["q", "2"]}], "]"}]}], ")"}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a1_.", "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], "2"], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a1", "//", "Simplify"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "//.", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], "+", " ", 
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", "c_"}], "]"}]}], "\[RuleDelayed]", " ", 
         RowBox[{"sp", "[", 
          RowBox[{"a", ",", 
           RowBox[{"b", "+", "c"}]}], "]"}]}], "}"}]}], ")"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"WithTripplejj", "=", 
  RowBox[{"%", "//.", "PartialFractioing"}]}]}], "Input",
 CellChangeTimes->{{3.7216506210133038`*^9, 3.721650622508955*^9}, {
  3.721650673078382*^9, 3.721650695933428*^9}, {3.721650872685955*^9, 
  3.721650875445529*^9}, {3.721651057037097*^9, 3.72165105996566*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "j"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "j"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["p", "j"]}], ")"}]}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.721650623093751*^9, {3.721650673834128*^9, 3.721650696338728*^9}, 
   3.721650807846117*^9, 3.721650876221822*^9, 3.721651074151059*^9, 
   3.72165117490497*^9, 3.721651268343637*^9, 3.721651348040949*^9, 
   3.721652269090632*^9, 3.721652338143827*^9, 3.7216715234067802`*^9, 
   3.721671567133774*^9, 3.721671997692477*^9, 3.721676866727893*^9, 
   3.721724885701523*^9, 3.7220601845509033`*^9, 3.7220648095238237`*^9, 
   3.722071798191678*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WithTripple", "-", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"WithTripple", ",", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          SubscriptBox["p", "j"]}], "]"}], ",", "1"}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"WithTripple", ",", 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["p", "i"]}], "]"}], ",", "1"}], "]"}], 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], "]"}]}]}], "//", "Simplify"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1_.", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"a2_.", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a1", "+", "a2"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "i"], ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "j"], ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "2"], 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["q", "1"], ",", 
           SubscriptBox["q", "2"]}], "]"}]}], ")"}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a1_.", "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], "2"], 
        SuperscriptBox[
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           RowBox[{
            SubscriptBox["q", "1"], "+", 
            SubscriptBox["q", "2"]}]}], "]"}], "2"], 
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["q", "1"], ",", 
          SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          SuperscriptBox[
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "2"], 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}]}], ")"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"r_", " ", 
           RowBox[{"sp", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}]}], "+", 
          RowBox[{"r_", " ", 
           RowBox[{"sp", "[", 
            RowBox[{"a_", ",", "c_"}], "]"}]}]}], "\[RuleDelayed]", 
         RowBox[{"r", " ", 
          RowBox[{"sp", "[", 
           RowBox[{"a", ",", 
            RowBox[{"b", "+", "c"}]}], "]"}]}]}], "}"}]}], ")"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"WithTrippleij", "=", 
  RowBox[{
  "%", "//.", "PartialFractioing"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.721647924824847*^9, 3.721648166252515*^9}, {
  3.721649434705666*^9, 3.7216494847923822`*^9}, {3.721649575778924*^9, 
  3.7216497857717943`*^9}, {3.721649843090198*^9, 3.721650027510421*^9}, {
  3.721650073206668*^9, 3.721650107779778*^9}, {3.7216501593613358`*^9, 
  3.721650179598859*^9}, {3.721650218924304*^9, 3.721650268961295*^9}, {
  3.721650837367188*^9, 3.7216508522920628`*^9}, {3.721651067429941*^9, 
  3.721651070253681*^9}, {3.721651113389086*^9, 3.721651165369459*^9}, {
  3.7216512446415987`*^9, 3.721651247847989*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "1"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       SubscriptBox["q", "2"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "1"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"sp", "(", 
     RowBox[{
      SubscriptBox["p", "i"], ",", 
      SubscriptBox["p", "j"]}], ")"}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"8", " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], ")"}]}], 
    RowBox[{
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "j"], ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], ")"}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.721650264786989*^9, 3.721650269729741*^9}, 
   3.721650807712472*^9, 3.721650853984125*^9, 3.721651070729615*^9, {
   3.721651127346972*^9, 3.7216511660910254`*^9}, {3.72165124947081*^9, 
   3.72165126849069*^9}, 3.721652269230489*^9, 3.721652338208733*^9, 
   3.721671523589964*^9, 3.721671567313151*^9, 3.721671997852947*^9, 
   3.721676866955158*^9, 3.721724885863537*^9, 3.722060184734029*^9, 
   3.722064809631925*^9, 3.7220717983166637`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "5", "]"}], "=", 
   RowBox[{"WithTripplejj", "+", "WithTrippleii", "+", "WithTrippleij"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ctr", "[", "5", "]"}], "-", "WithTripple"}], "//", 
  "KinSimplify"}]}], "Input",
 CellChangeTimes->{{3.721650892319949*^9, 3.721650947947712*^9}, {
   3.721651016850082*^9, 3.721651028427649*^9}, {3.7216513099415407`*^9, 
   3.721651333966111*^9}, 3.721651389142146*^9, {3.721651535531313*^9, 
   3.721651554098715*^9}, 3.721651647756291*^9}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721651547121211*^9, 3.721651554561963*^9}, 
   3.721651648303773*^9, 3.721652269269025*^9, 3.721652338276129*^9, 
   3.721671523639573*^9, 3.721671567353017*^9, 3.721671997886856*^9, 
   3.7216768669949503`*^9, 3.721724885891078*^9, 3.7220601847483273`*^9, 
   3.722064809647026*^9, 3.7220717983423777`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NonBubbleLike", "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Ctr", "[", "jc", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"jc", ",", "2", ",", "5"}], "}"}]}], "]"}]}], "//", 
  "KinSimplify"}]], "Input",
 CellChangeTimes->{{3.7216522855451517`*^9, 3.721652287558384*^9}, {
  3.7216523421550827`*^9, 3.721652358203374*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.7216523383454943`*^9, 3.7216523586922398`*^9}, 
   3.721671523689163*^9, 3.7216715674055634`*^9, 3.721671997927174*^9, 
   3.721676867047505*^9, 3.721724885932825*^9, 3.722060184772813*^9, 
   3.722064809671199*^9, 3.722071798369568*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"List", "@@", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Ctr", "[", "jc", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"jc", ",", "2", ",", "5"}], "}"}]}], "]"}]}], "//", 
   RowBox[{"Simplify", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1___", ",", 
         RowBox[{"c1_.", " ", "a_"}], ",", "x2___", ",", "b_", ",", "x3___"}],
         "}"}], "/;", 
       RowBox[{"NumericQ", "[", "c1", "]"}]}], "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", 
        RowBox[{
         RowBox[{"c1", " ", "a"}], "+", "b"}]}], "}"}]}], "}"}]}]}], "//", 
  "Length"}]], "Input",
 CellChangeTimes->{{3.72165236479799*^9, 3.721652379054049*^9}, {
  3.721652423363875*^9, 3.721652425988493*^9}, {3.7216524562340813`*^9, 
  3.721652564846507*^9}}],

Cell[BoxData[
 FormBox["34", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721652368374731*^9, 3.721652379461781*^9}, 
   3.721652426336931*^9, {3.721652556712603*^9, 3.721652565555526*^9}, 
   3.7216715237398376`*^9, 3.721671567456622*^9, 3.721671997974619*^9, 
   3.721676867096551*^9, 3.721724885984902*^9, 3.7220601847953167`*^9, 
   3.722064809693495*^9, 3.722071798395789*^9}]
}, Open  ]],

Cell["Final cross-check:", "Text",
 CellChangeTimes->{{3.721652607259145*^9, 3.721652615514192*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"STotal", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Ctr", "[", "jc", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"jc", ",", "0", ",", "5"}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sw0", "\[Rule]", "1"}], ",", 
     RowBox[{"sw1", "\[Rule]", "1"}]}], "}"}]}], "//", 
  "KinSimplify"}]], "Input",
 CellChangeTimes->{{3.721652714158557*^9, 3.7216527343238792`*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.7216527182696877`*^9, 3.721652735556758*^9}, 
   3.721653076913228*^9, 3.7216715238290167`*^9, 3.721671567524619*^9, 
   3.7216719980461273`*^9, 3.721676867183523*^9, 3.721724886059828*^9, 
   3.722060184841013*^9, 3.722064809733679*^9, 3.722071798438634*^9}]
}, Open  ]],

Cell["Hence we can have the final list:", "Text",
 CellChangeTimes->{{3.721652794683547*^9, 3.721652803266612*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FinalList", "=", 
   RowBox[{"List", "@@", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Ctr", "[", "jc", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sw0", "\[Rule]", "1"}], ",", 
          RowBox[{"sw1", "\[Rule]", "1"}]}], "}"}]}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"jc", ",", "2", ",", "5"}], "}"}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.721652810226521*^9, 3.721652840784737*^9}, {
   3.721653010460927*^9, 3.721653069458192*^9}, {3.721653489419119*^9, 
   3.721653490697556*^9}, {3.721653710119569*^9, 3.7216537101906147`*^9}, 
   3.721656663184245*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721652860801899*^9, 3.721652984658944*^9}, 
   3.721653066445158*^9, {3.721653742539063*^9, 3.721653817575757*^9}, {
   3.72165385656968*^9, 3.721654017499543*^9}, {3.7216540875165997`*^9, 
   3.721654102845722*^9}, {3.721656656329504*^9, 3.7216566589674177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinalList", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.721656277718725*^9, 3.7216562789456863`*^9}, 
   3.7216566542491827`*^9}],

Cell[BoxData[
 FormBox["34", TraditionalForm]], "Output",
 CellChangeTimes->{3.721656279324951*^9, 3.7216715239016848`*^9, 
  3.7216715675860453`*^9, 3.721671998130413*^9, 3.721676867266424*^9, 
  3.7217248861418858`*^9, 3.722060184910486*^9, 3.722064809750536*^9, 
  3.722071798471973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FinalListij", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FinalList", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{"a_", ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"sp", "[", 
            RowBox[{"a", ",", "q"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["q", "1"], ",", 
             SubscriptBox["q", "2"]}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"q", ",", "q"}], "]"}], "/", "2"}]}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1___", ",", " ", "x2_", ",", "x3___"}], "}"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"x2", ",", 
               SubscriptBox["q", "1"]}], "]"}], "&&", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"x2", ",", 
               SubscriptBox["q", "2"]}], "]"}]}], "||", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"x2", ",", 
              SubscriptBox["p", "j"]}], "]"}], "||", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"x2", ",", 
              SubscriptBox["p", "i"]}], "]"}]}], ")"}]}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x3"}], "}"}]}], "}"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"q", ",", "q"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"2", 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], "]"}]}]}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"a_", ",", "q"}], "]"}], ":>", 
      RowBox[{"sp", "[", 
       RowBox[{"a", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.721654084942727*^9, 3.721654085077001*^9}, {
   3.7216541150969048`*^9, 3.7216542963651114`*^9}, {3.721654473887063*^9, 
   3.721654494574287*^9}, {3.7216546017557364`*^9, 3.7216546091546183`*^9}, {
   3.721655005301004*^9, 3.721655005981319*^9}, {3.721655068748801*^9, 
   3.721655078961817*^9}, {3.7216565759235497`*^9, 3.721656578075021*^9}, {
   3.7216566494946747`*^9, 3.72165665083985*^9}, {3.7216568380118637`*^9, 
   3.721656846740549*^9}, 3.7216715618488283`*^9}],

Cell[BoxData[
 FormBox["25", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721654274999351*^9, 3.721654296716827*^9}, 
   3.721654337571692*^9, 3.721654409230397*^9, {3.7216544869945297`*^9, 
   3.721654495548812*^9}, 3.721654609773086*^9, 3.7216550093019133`*^9, 
   3.721655079270458*^9, 3.721656579550723*^9, 3.721656651367854*^9, 
   3.7216568475887623`*^9, 3.721671523957934*^9, 3.7216715676348352`*^9, 
   3.72167199817562*^9, 3.7216768673908787`*^9, 3.721724886184987*^9, 
   3.7220601849375353`*^9, 3.722064809763207*^9, 3.722071798502718*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FinalListq", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FinalList", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"sp", "[", 
           RowBox[{"a", ",", "q"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{"q", ",", "q"}], "]"}], "/", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1___", ",", "x2_", ",", "x3___"}], "}"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"x2", ",", 
              SubscriptBox["q", "1"]}], "]"}], "===", "False"}], "||", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"x2", ",", 
              SubscriptBox["q", "2"]}], "]"}], "===", "False"}]}], ")"}]}], 
        " ", "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x3"}], "}"}]}], "}"}]}], ")"}], "/.", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"q", ",", "q"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"2", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], "]"}]}]}]}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"a_", ",", "q"}], "]"}], ":>", 
     RowBox[{"sp", "[", 
      RowBox[{"a", ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.721655290106502*^9, 3.721655503011338*^9}, 
   3.721655655809915*^9, {3.721656611135445*^9, 3.7216566438106203`*^9}, {
   3.721656761339364*^9, 3.721656787171237*^9}, 3.7216568277907267`*^9, 
   3.721671558826961*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], "2"]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"8", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "j"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.721655305018923*^9, {3.72165535324375*^9, 3.721655408259412*^9}, {
   3.721655445376246*^9, 3.7216554650545683`*^9}, 3.7216555037832737`*^9, 
   3.7216556563066*^9, {3.7216566196823397`*^9, 3.721656645032361*^9}, {
   3.721656775089343*^9, 3.721656788152219*^9}, 3.72165682843645*^9, 
   3.7216715240075006`*^9, 3.7216715676838512`*^9, 3.7216719982264767`*^9, 
   3.7216768674455748`*^9, 3.721724886236787*^9, 3.722060184972528*^9, 
   3.722064809782606*^9, 3.722071798540141*^9}],

Cell[BoxData[
 FormBox["3", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.721655305018923*^9, {3.72165535324375*^9, 3.721655408259412*^9}, {
   3.721655445376246*^9, 3.7216554650545683`*^9}, 3.7216555037832737`*^9, 
   3.7216556563066*^9, {3.7216566196823397`*^9, 3.721656645032361*^9}, {
   3.721656775089343*^9, 3.721656788152219*^9}, 3.72165682843645*^9, 
   3.7216715240075006`*^9, 3.7216715676838512`*^9, 3.7216719982264767`*^9, 
   3.7216768674455748`*^9, 3.721724886236787*^9, 3.722060184972528*^9, 
   3.722064809782606*^9, 3.722071798541098*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FinalListiiOrjj", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FinalList", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"sp", "[", 
           RowBox[{"a", ",", "q"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{"q", ",", "q"}], "]"}], "/", "2"}]}]}], "}"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1___", ",", "x2_", ",", "x3___"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"x2", ",", 
              SubscriptBox["q", "1"]}], "]"}], "&&", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"x2", ",", 
              SubscriptBox["q", "2"]}], "]"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"x2", ",", 
               SubscriptBox["p", "j"]}], "]"}], "===", "False"}], "&&", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"x2", ",", 
               SubscriptBox["p", "i"]}], "]"}], "===", "False"}]}], ")"}]}]}],
         " ", "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x3"}], "}"}]}], "}"}]}], ")"}], "/.", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"q", ",", "q"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"2", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], "]"}]}]}]}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sp", "[", 
      RowBox[{"a_", ",", "q"}], "]"}], ":>", 
     RowBox[{"sp", "[", 
      RowBox[{"a", ",", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        SubscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.7216556478183002`*^9, 3.7216556528566723`*^9}, {
  3.721655703811656*^9, 3.7216557397401533`*^9}, {3.721655904682413*^9, 
  3.721655908490547*^9}, {3.721656217557336*^9, 3.721656247950338*^9}, {
  3.721656294109124*^9, 3.721656320668593*^9}, {3.721656353685774*^9, 
  3.721656353878079*^9}, {3.721656388876513*^9, 3.7216563975959*^9}, {
  3.721656428645781*^9, 3.721656538918673*^9}, {3.7216566254091*^9, 
  3.721656638061802*^9}, {3.721656706672572*^9, 3.721656752578526*^9}, {
  3.721656804597686*^9, 3.721656811661207*^9}, {3.721671547630197*^9, 
  3.721671552252203*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}], "2"], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["p", "j"]}], ")"}], "2"], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "j"], ",", 
          RowBox[{
           SubscriptBox["q", "1"], "+", 
           SubscriptBox["q", "2"]}]}], ")"}], "2"]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], ")"}], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], ")"}], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.721655718213335*^9, 3.721655747709364*^9}, 
   3.721655825507226*^9, 3.721655868559544*^9, {3.721655903261509*^9, 
   3.7216559089578342`*^9}, {3.721656232431592*^9, 3.72165624848534*^9}, {
   3.721656304254642*^9, 3.7216563219665203`*^9}, {3.7216564090038357`*^9, 
   3.721656463343502*^9}, {3.721656535352641*^9, 3.721656539468617*^9}, {
   3.721656630923313*^9, 3.721656639208497*^9}, 3.721656753095667*^9, 
   3.721656815135982*^9, {3.721671524058147*^9, 3.721671533209874*^9}, 
   3.7216715677307053`*^9, 3.7216719982929287`*^9, 3.721676867511549*^9, 
   3.721724886302919*^9, 3.7220601850023727`*^9, 3.722064809807125*^9, 
   3.7220717985825663`*^9}],

Cell[BoxData[
 FormBox["6", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721655718213335*^9, 3.721655747709364*^9}, 
   3.721655825507226*^9, 3.721655868559544*^9, {3.721655903261509*^9, 
   3.7216559089578342`*^9}, {3.721656232431592*^9, 3.72165624848534*^9}, {
   3.721656304254642*^9, 3.7216563219665203`*^9}, {3.7216564090038357`*^9, 
   3.721656463343502*^9}, {3.721656535352641*^9, 3.721656539468617*^9}, {
   3.721656630923313*^9, 3.721656639208497*^9}, 3.721656753095667*^9, 
   3.721656815135982*^9, {3.721671524058147*^9, 3.721671533209874*^9}, 
   3.7216715677307053`*^9, 3.7216719982929287`*^9, 3.721676867511549*^9, 
   3.721724886302919*^9, 3.7220601850023727`*^9, 3.722064809807125*^9, 
   3.722071798584148*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Plus", "@@", "FinalList"}], ")"}], "-", 
  RowBox[{"(", 
   RowBox[{"Plus", "@@", "FinalListij"}], ")"}], "-", 
  RowBox[{"(", 
   RowBox[{"Plus", "@@", "FinalListq"}], ")"}], "-", 
  RowBox[{"(", 
   RowBox[{"Plus", "@@", "FinalListiiOrjj"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.721656676278171*^9, 3.721656696951995*^9}, {
  3.7216568523866997`*^9, 3.721656856507045*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{3.721656857763866*^9, 3.72167152418521*^9, 
  3.721671567782875*^9, 3.72167199834254*^9, 3.721676867561996*^9, 
  3.721724886369652*^9, 3.722060185017825*^9, 3.722064809818143*^9, 
  3.722071798609562*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"STotal", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "-", 
     RowBox[{"Plus", "@@", "FinalList"}], "-", 
     RowBox[{"Ctr", "[", "0", "]"}], "-", 
     RowBox[{"Ctr", "[", "1", "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sw0", "\[Rule]", "1"}], ",", 
      RowBox[{"sw1", "\[Rule]", "1"}]}], "}"}]}], ")"}], "//", 
  "KinSimplify"}]], "Input",
 CellChangeTimes->{{3.721657042330162*^9, 3.721657045170403*^9}, {
  3.7216570751969223`*^9, 3.721657160126906*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721657104230242*^9, 3.721657160705061*^9}, 
   3.721671524222672*^9, 3.7216715678342743`*^9, 3.72167199839326*^9, 
   3.721676867645337*^9, 3.721724886419544*^9, 3.722060185042164*^9, 
   3.722064809832234*^9, 3.72207179863664*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Final preparations of lists", "Subsubsection",
 CellChangeTimes->{{3.721663688495213*^9, 3.721663692542589*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Masterij", "[", 
   RowBox[{"pi_", ",", "pj_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"FinalListij", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "i"], "\[RuleDelayed]", "pi"}], ",", 
       RowBox[{
        SubscriptBox["p", "j"], "\[RuleDelayed]", "pj"}]}], "}"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1___", ",", "x2_", ",", "x3___", ",", "x4_", ",", "x5___"}],
         "}"}], "/;", 
       RowBox[{"x2", "===", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x4", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "\[Rule]", 
              SubscriptBox["q", "2"]}], ",", 
             RowBox[{
              SubscriptBox["q", "2"], "\[Rule]", 
              SubscriptBox["q", "1"]}]}], "}"}]}], "//", "Simplify"}], 
         ")"}]}]}], ":>", 
      RowBox[{"{", 
       RowBox[{"x1", ",", 
        RowBox[{"2", "x2"}], ",", "x3", ",", "x5"}], "}"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"p1", ",", "p1"}], "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"p2", ",", "p2"}], "]"}], "->", "0"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.721661738774387*^9, 3.721661821265183*^9}, {
   3.721671618256926*^9, 3.7216717523399343`*^9}, {3.721671897694042*^9, 
   3.7216719125732603`*^9}, {3.7216719571268253`*^9, 3.721671958278695*^9}, {
   3.721672026054278*^9, 3.7216720433057413`*^9}, 3.721672191001781*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"List13Plus24", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aux1", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Masterij", "[", 
      RowBox[{"p1", ",", "p3"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aux2", "=", 
   RowBox[{"aux1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p1", "\[Rule]", "p2"}], ",", 
      RowBox[{"p3", "\[Rule]", "p4"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"List13Plus24", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"List13Plus24", ",", 
        RowBox[{"aux1", "[", 
         RowBox[{"[", "jc", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"List13Plus24", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"List13Plus24", ",", 
        RowBox[{"aux2", "[", 
         RowBox[{"[", "jc", "]"}], "]"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"jc", ",", "1", ",", 
      RowBox[{"Length", "[", "aux1", "]"}]}], "}"}]}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.721661983140312*^9, 3.7216620200299788`*^9}, {
   3.721662060776099*^9, 3.721662486059029*^9}, {3.7216625227143517`*^9, 
   3.721662765811304*^9}, {3.721662801593411*^9, 3.721662876150118*^9}, 
   3.721671587726982*^9, {3.721671774911549*^9, 3.721671794781122*^9}, {
   3.721671878836287*^9, 3.7216718881331797`*^9}, {3.721672076168928*^9, 
   3.721672076537078*^9}, 3.721725263141554*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cofs1324", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cofs1324", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"Cofs1324", ",", " ", 
        RowBox[{"Sign", "[", " ", 
         RowBox[{
          RowBox[{"List13Plus24", "[", 
           RowBox[{"[", "jc", "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sp", "[", "__", "]"}], ":>", "1"}], "}"}]}], "]"}]}], 
       "    ", "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"jc", ",", "1", ",", 
      RowBox[{"Length", "[", "List13Plus24", "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.721662880405954*^9, 3.721663092075665*^9}, 
   3.7216638947247667`*^9, {3.721663931662204*^9, 3.721663953557062*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"List13Plus24Ready", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"List13Plus24Ready", "=", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"List13Plus24Ready", ",", 
      RowBox[{
       RowBox[{"List13Plus24", "[", 
        RowBox[{"[", "jc", "]"}], "]"}], "*", 
       RowBox[{"Cofs1324", "[", 
        RowBox[{"[", "jc", "]"}], "]"}]}]}], "  ", "]"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"jc", ",", "1", ",", 
     RowBox[{"List13Plus24", "//", "Length"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.721663203820269*^9, 3.721663299629986*^9}, {
  3.721663738463471*^9, 3.721663787914549*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"List13Plus24Ready", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.721663850571535*^9, 3.721663852972208*^9}, 
   3.721663958628511*^9, {3.721672094481861*^9, 3.721672096234549*^9}}],

Cell[BoxData[
 FormBox["18", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721663781201226*^9, 3.72166379161521*^9}, {
   3.721663848232266*^9, 3.721663853356214*^9}, {3.721663942615055*^9, 
   3.721663958985629*^9}, 3.721671524334601*^9, 3.7216715764992113`*^9, 
   3.72167180133366*^9, 3.721671998650847*^9, {3.721672090228149*^9, 
   3.7216720967213173`*^9}, 3.721672207538004*^9, 3.721676867979822*^9, 
   3.72172488659692*^9, {3.721725273227294*^9, 3.721725286586651*^9}, 
   3.7220601851156797`*^9, 3.722064809894889*^9, 3.722071798719595*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["List13Plus24Ready"], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", "p3"}], ")"}], "2"], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "2"]}], ")"}]}]], ",", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", "p4"}], ")"}], "2"], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "2"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{"p1", ",", "p3"}], ")"}], "2"]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{"p2", ",", "p4"}], ")"}], "2"]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", "p3"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", "p3"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", "p4"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", "p4"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", "p3"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", "p4"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", "p3"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", "p4"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", "p3"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", "p4"}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", "p3"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", "p4"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", "p3"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", "p4"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", "p3"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        SubscriptBox["q", "2"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p1", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p3", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", "p4"}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        SubscriptBox["q", "2"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p2", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{"p4", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.7216722418765173`*^9, 3.721676868027959*^9, 3.721724886637475*^9, {
   3.721725275796834*^9, 3.721725286637738*^9}, 3.722060185170424*^9, 
   3.722064809948167*^9, 3.722071798802629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Cofs1324"], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
     "1", ",", "1", ",", "1", ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.721725290529368*^9, 3.722060185208445*^9, 
  3.7220648099789553`*^9, 3.7220717988305817`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Czakon ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "ij"], TraditionalForm]]],
 "without bubble gluon+ghost "
}], "Subsection",
 CellChangeTimes->{{3.7212075606195583`*^9, 3.7212075690833683`*^9}, {
  3.72156200923345*^9, 3.7215620131201363`*^9}, {3.721562406599434*^9, 
  3.721562409149002*^9}, {3.7215686416417913`*^9, 3.721568653241392*^9}, {
  3.721987372473914*^9, 3.721987433744932*^9}, {3.7219877583545227`*^9, 
  3.721987778938801*^9}}],

Cell[CellGroupData[{

Cell["\<\
In in the Feynman gauge, physical polarisation vectors can be trade off by a \
ghost:\
\>", "Subsubsection",
 CellChangeTimes->{{3.721561692525393*^9, 3.721561713910047*^9}, {
  3.721567878067986*^9, 3.721567881267003*^9}, {3.721568512303466*^9, 
  3.721568524790701*^9}, {3.721633905513411*^9, 3.721633937851006*^9}}],

Cell["Feynman Gauge approach with ghost:", "Text",
 CellChangeTimes->{{3.721567487637598*^9, 3.721567496037141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SijNoBubble", "[", 
    RowBox[{"jj_", ",", "ii_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Plus", "@@", "Kij2"}], ")"}], "+", "Ghostij2"}], ",", 
            RowBox[{"CA", 
             RowBox[{
              SubscriptBox["T", "i"], "\[CenterDot]", 
              SubscriptBox["T", "j"]}]}]}], "]"}], ")"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "+", 
            RowBox[{"sp", "[", 
             RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["q", "ir_"], ",", 
             SubscriptBox["q", "ir_"]}], "]"}], "\[Rule]", "0"}], ",", 
          RowBox[{"sw1", "\[Rule]", "1"}], ",", 
          RowBox[{"sw2", "\[Rule]", "0"}], ",", 
          RowBox[{"sw3", "\[Rule]", "0"}], ",", 
          RowBox[{
           SuperscriptBox["sw0", "2"], "\[Rule]", "sw02"}]}], "}"}]}], 
       ")"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sw0", "\[Rule]", "1"}], ",", 
       RowBox[{"sw02", "\[Rule]", "0"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "\[Rule]", "ii"}], ",", 
      RowBox[{"j", "\[Rule]", "jj"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721568982282179*^9, 3.721569079509142*^9}, {
  3.721569395112479*^9, 3.721569434913287*^9}, {3.721569486247671*^9, 
  3.721569491977438*^9}, {3.7215695744755383`*^9, 3.721569581987259*^9}, {
  3.721569684586678*^9, 3.7215696880247583`*^9}, {3.7215697358705063`*^9, 
  3.7215697363882837`*^9}, {3.7219898050335197`*^9, 3.721989819152396*^9}, {
  3.7219898748695517`*^9, 3.721989875278164*^9}, {3.721989937342292*^9, 
  3.721989941174461*^9}, {3.7219900001218643`*^9, 3.7219900111993217`*^9}, {
  3.721990107502266*^9, 3.721990159201516*^9}, {3.721990406286605*^9, 
  3.7219904295345163`*^9}, {3.7219906201200657`*^9, 3.721990620463994*^9}, {
  3.721990703560761*^9, 3.72199073666409*^9}, {3.721990799193529*^9, 
  3.721990839199621*^9}, {3.721990947577979*^9, 3.721990963760778*^9}, {
  3.721991023985963*^9, 3.7219910607246437`*^9}, {3.721991240434116*^9, 
  3.721991240856756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bubble", "[", 
    RowBox[{"jj_", ",", "ii_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Plus", "@@", "Kij2"}], ")"}], "+", "Ghostij2"}], ",", 
           RowBox[{
            SuperscriptBox["sw0", "2"], "CA", " ", 
            RowBox[{
             SubscriptBox["T", "i"], "\[CenterDot]", 
             SubscriptBox["T", "j"]}]}]}], "]"}], ")"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{"a_", ",", 
            RowBox[{"b_", "+", "c_"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{"a", ",", "b"}], "]"}], "+", 
           RowBox[{"sp", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["q", "ir_"], ",", 
            SubscriptBox["q", "ir_"]}], "]"}], "\[Rule]", "0"}], ",", 
         RowBox[{"sw1", "\[Rule]", "1"}], ",", 
         RowBox[{"sw2", "\[Rule]", "0"}], ",", 
         RowBox[{"sw3", "\[Rule]", "0"}]}], "}"}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "\[Rule]", "ii"}], ",", 
      RowBox[{"j", "\[Rule]", "jj"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7219906547513533`*^9, 3.721990679341016*^9}, {
   3.721990860501511*^9, 3.7219909173444967`*^9}, {3.721990953049035*^9, 
   3.721990959042485*^9}, {3.721991102265456*^9, 3.721991109270878*^9}, {
   3.721991161165287*^9, 3.721991168361459*^9}, 3.721991219785369*^9}],

Cell[TextData[{
 "Observe that the sum of bubble plus NoBubble is equal, up to terms that \
vanish due to colour conservation, to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Spartial", " ", 
    RowBox[{"(", 
     RowBox[{"=", 
      RowBox[{
       SubscriptBox["S", 
        RowBox[{
         RowBox[{"ij", "  ", "m"}], "=", "0"}]], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["m", "i"], "2"], 
        SubscriptBox["S", 
         RowBox[{
          RowBox[{"ij", "  ", "m"}], "=!=", "0"}]]}], "+"}]}]}]}], 
   TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["m", "j"], "2"], 
    SubscriptBox["S", 
     RowBox[{
      RowBox[{"ji", "  ", "m"}], "=!=", "0"}]]}], TraditionalForm]]],
 "), i.e."
}], "Text",
 CellChangeTimes->{{3.721991249789628*^9, 3.721991264903288*^9}, {
  3.721991362344*^9, 3.72199149717589*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SijNoBubble", "[", 
    RowBox[{"j", ",", "i"}], "]"}], "+", 
   RowBox[{"Bubble", "[", 
    RowBox[{"j", ",", "i"}], "]"}], "-", 
   RowBox[{"SPartial", "[", 
    RowBox[{"j", ",", "i"}], "]"}]}], "//", "KinSimplify"}]], "Input",
 CellChangeTimes->{{3.7219907533230333`*^9, 3.721990789896755*^9}, {
  3.721991246103023*^9, 3.7219912464861107`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["p", "j"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}]], "+", "d", "-", "6"}], 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.721990790829691*^9, 3.7219908046560583`*^9}, 
   3.721990846373885*^9, 3.721990902366166*^9, 3.721990942189107*^9, 
   3.721991114176436*^9, {3.721991203925137*^9, 3.721991268697597*^9}, 
   3.721995939114937*^9, 3.7219971856640663`*^9, 3.722060185561983*^9, {
   3.7220603997613707`*^9, 3.722060421321916*^9}, 3.722064810309231*^9, 
   3.7220682990537148`*^9, 3.722071799204873*^9}]
}, Open  ]],

Cell["\<\
We shall now transform SijNoBubble[j,i] into a convenient list for  evaluation\
\>", "Text",
 CellChangeTimes->{{3.721991309592556*^9, 3.721991346983955*^9}, {
  3.7219915058163548`*^9, 3.721991514644567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SemiAbelian", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"SijNoBubble", "[", 
      RowBox[{"j", ",", "i"}], "]"}], ",", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], "]"}], ",", "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721991538762952*^9, 3.721991594822927*^9}, {
  3.721991630501237*^9, 3.7219916314929543`*^9}, {3.7219920745362673`*^9, 
  3.721992096583517*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Piece", "[", "1", "]"}], "=", 
   RowBox[{"List", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"SemiAbelian", ",", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           SubscriptBox["p", "i"]}], "]"}]}], "]"}], 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], "]"}]}], "//", "Expand"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Piece", "[", "2", "]"}], "=", 
   RowBox[{"List", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"SemiAbelian", ",", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "j"], ",", 
           SubscriptBox["p", "j"]}], "]"}]}], "]"}], 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["p", "j"]}], "]"}]}], "//", "Expand"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Piece", "[", "3", "]"}], "=", 
   RowBox[{"List", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"SemiAbelian", ",", 
         SuperscriptBox[
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "i"], ",", 
            SubscriptBox["p", "j"]}], "]"}], "2"]}], "]"}], 
       SuperscriptBox[
        RowBox[{"sp", "[", 
         RowBox[{
          SubscriptBox["p", "i"], ",", 
          SubscriptBox["p", "j"]}], "]"}], "2"]}], "//", "Expand"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.721992099442945*^9, 3.721992158632391*^9}, {
   3.7219922068962727`*^9, 3.721992344520361*^9}, {3.721992464098014*^9, 
   3.721992525553027*^9}, 3.721992911816264*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SemiAbelian", "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Plus", "@@", 
       RowBox[{"Piece", "[", "ic", "]"}]}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"ic", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "//", 
  "KinSimplify"}]], "Input",
 CellChangeTimes->{{3.721992502237022*^9, 3.721992552870998*^9}, {
  3.7219926124508266`*^9, 3.721992612545043*^9}, {3.721995759631381*^9, 
  3.721995760599119*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.721992528527149*^9, 3.721992572975219*^9}, {
   3.721992609934738*^9, 3.7219926129625683`*^9}, {3.7219957614295273`*^9, 
   3.721995766217154*^9}, 3.721995939303382*^9, 3.721997185834445*^9, 
   3.722060185714183*^9, {3.722060399912787*^9, 3.722060421475349*^9}, 
   3.72206481045651*^9, 3.722071799397408*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"JoinScalar", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        SubscriptBox["q", "r_"]}], "]"}], "+", 
      RowBox[{"sp", "[", 
       RowBox[{
        SubscriptBox["p", "t_"], ",", 
        SubscriptBox["q", "s_"]}], "]"}]}], ":>", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["p", "t"], ",", 
       RowBox[{
        SubscriptBox["q", "r"], "+", 
        SubscriptBox["q", "s"]}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721994787751566*^9, 3.721994900483534*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PartialFractioning2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1___", ",", 
       FractionBox[
        RowBox[{"f_", " ", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "t_"], ",", 
           SubscriptBox["q", "s_"]}], "]"}]}], 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "t_"], ",", 
           SubscriptBox["q", "r_"]}], "]"}], " ", "g_", 
         RowBox[{"(", 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "t_"], ",", 
            RowBox[{
             SubscriptBox["q", "r_"], "+", 
             SubscriptBox["q", "s_"]}]}], "]"}], ")"}]}]], ",", "x2___"}], 
      "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{" ", "f", " "}], 
        RowBox[{
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "t"], ",", 
           SubscriptBox["q", "r"]}], "]"}], "g"}]], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{" ", "f", " "}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "t"], ",", 
             RowBox[{
              SubscriptBox["q", "r"], "+", 
              SubscriptBox["q", "s"]}]}], "]"}], ")"}], "g"}]]}], ",", "x2"}],
       "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CancelNumerator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1___", ",", 
       FractionBox[
        RowBox[{"f_", " ", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "t_"], ",", 
           SubscriptBox["q", "s_"]}], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sp", "[", 
           RowBox[{
            SubscriptBox["p", "t_"], ",", 
            RowBox[{
             SubscriptBox["q", "r_"], "+", 
             SubscriptBox["q", "s_"]}]}], "]"}], ")"}], "g_"}]], ",", "x2___",
        ",", 
       FractionBox[
        RowBox[{"f_", " ", 
         RowBox[{"sp", "[", 
          RowBox[{
           SubscriptBox["p", "t_"], ",", 
           SubscriptBox["q", "r_"]}], "]"}]}], 
        RowBox[{" ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "t_"], ",", 
             RowBox[{
              SubscriptBox["q", "r_"], "+", 
              SubscriptBox["q", "s_"]}]}], "]"}], ")"}], "g_"}]}]], ",", 
       "x3___"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       FractionBox[
        RowBox[{"f", " "}], "g"], ",", "x2", ",", "x3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThrowGaugeTerms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1___", ",", "x2_", ",", "x3___"}], "}"}], "/;", 
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"x2", ",", 
         SubscriptBox["p", "i"]}], "]"}], "||", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"x2", ",", 
         SubscriptBox["p", "j"]}], "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"x2", ",", 
           SubscriptBox["p", "i"]}], "]"}], "&&", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"x2", ",", 
           SubscriptBox["p", "j"]}], "]"}]}], ")"}]}]}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "x3"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7219929216276712`*^9, 3.7219929305650883`*^9}, 
   3.721993632590822*^9, {3.7219937314797993`*^9, 3.721993787128004*^9}, {
   3.721993954777788*^9, 3.721993962094673*^9}, {3.721994214200732*^9, 
   3.721994372120716*^9}, {3.721994642330558*^9, 3.7219946462650957`*^9}, {
   3.721994767037325*^9, 3.721994780344685*^9}, {3.7219952456092997`*^9, 
   3.721995355241942*^9}, 3.721995392049802*^9, {3.722060362308832*^9, 
   3.722060390084813*^9}, {3.722072069841462*^9, 3.722072081444174*^9}, {
   3.722072321248033*^9, 3.722072334512439*^9}, 3.7220742355566893`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonAbelian", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"SijNoBubble", "[", 
        RowBox[{"j", ",", "i"}], "]"}], ",", 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], "/", 
     RowBox[{"sp", "[", 
      RowBox[{
       SubscriptBox["q", "1"], ",", 
       SubscriptBox["q", "2"]}], "]"}]}], " ", "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72199262196577*^9, 3.721992648647945*^9}, {
  3.7219927115693407`*^9, 3.721992734225856*^9}, {3.721992825816195*^9, 
  3.721992827225677*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Piece", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"NonAbelian", ",", 
             RowBox[{"sp", "[", 
              RowBox[{
               SubscriptBox["p", "j"], ",", 
               SubscriptBox["p", "j"]}], "]"}]}], "]"}], 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "j"], ",", 
             SubscriptBox["p", "j"]}], "]"}]}], "//", "Expand"}], ")"}]}], 
       ")"}], "//.", "ThrowGaugeTerms"}], "//.", "JoinScalar"}], "//.", 
    "CancelNumerator"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Piece", "[", "5", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"NonAbelian", ",", 
             RowBox[{"sp", "[", 
              RowBox[{
               SubscriptBox["p", "i"], ",", 
               SubscriptBox["p", "i"]}], "]"}]}], "]"}], 
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["p", "i"], ",", 
             SubscriptBox["p", "i"]}], "]"}]}], "//", "Expand"}], ")"}]}], 
       ")"}], "//.", "ThrowGaugeTerms"}], "//.", "JoinScalar"}], "//.", 
    "CancelNumerator"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Piece", "[", "6", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NonAbelian", " ", "//.", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{
              SubscriptBox["p", "r_"], ",", 
              SubscriptBox["p", "r_"]}], "]"}], "\[RuleDelayed]", "0"}]}], "//",
           "Expand"}], ")"}]}], ")"}], "//.", "ThrowGaugeTerms"}], "//.", 
     "JoinScalar"}], "//.", "CancelNumerator"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.721992835016143*^9, 3.721992837301964*^9}, {
  3.7219929407301397`*^9, 3.72199297213623*^9}, {3.721993097290011*^9, 
  3.721993131931198*^9}, {3.721993285298345*^9, 3.721993355432148*^9}, {
  3.721994008637533*^9, 3.721994164879402*^9}, {3.721994385218341*^9, 
  3.721994441261915*^9}, {3.721994550813806*^9, 3.721994559044788*^9}, {
  3.7219949094708443`*^9, 3.721994922055582*^9}, {3.721995451280437*^9, 
  3.721995452966813*^9}, {3.7219957052517147`*^9, 3.721995734444817*^9}, {
  3.721996134872775*^9, 3.721996143651824*^9}, {3.721996179209586*^9, 
  3.721996238473563*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Piece", "[", "ic", "]"}]}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"ic", ",", "1", ",", "6"}], "}"}]}], "]"}], "+", 
    RowBox[{"Bubble", "[", 
     RowBox[{"j", ",", "i"}], "]"}], "-", 
    RowBox[{"SPartial", "[", 
     RowBox[{"j", ",", "i"}], "]"}]}], "//", "KinSimplify"}], "//", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.7219957720770493`*^9, 3.7219957886389027`*^9}, {
   3.721995819304454*^9, 3.721995861542633*^9}, 3.7219961527285347`*^9, {
   3.721996185839511*^9, 3.721996187219695*^9}, {3.721996320103901*^9, 
   3.721996324375896*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["3", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"]}]], "-", 
   FractionBox["d", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.7219959395428762`*^9, {3.721996153147336*^9, 3.721996244308881*^9}, 
   3.721996327168116*^9, 3.721997186247396*^9, 3.722060186166689*^9, {
   3.722060400243354*^9, 3.722060421906609*^9}, 3.722064810769771*^9, 
   3.722071799737364*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralCaseList", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Piece", "[", "1", "]"}], ",", 
     RowBox[{"Piece", "[", "2", "]"}], ",", 
     RowBox[{"Piece", "[", "3", "]"}], ",", 
     RowBox[{"Piece", "[", "4", "]"}], ",", 
     RowBox[{"Piece", "[", "5", "]"}], ",", 
     RowBox[{"Piece", "[", "6", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72199636489132*^9, 3.72199637936981*^9}, {
  3.7219968219578657`*^9, 3.721996923988435*^9}, {3.721997152865445*^9, 
  3.721997156565873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Plus", "@@", "GeneralCaseList"}], "+", 
    RowBox[{"Bubble", "[", 
     RowBox[{"j", ",", "i"}], "]"}], "-", 
    RowBox[{"SPartial", "[", 
     RowBox[{"j", ",", "i"}], "]"}]}], "//", "KinSimplify"}], "//", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.721996910672637*^9, 3.721996912399981*^9}, {
   3.721996950513484*^9, 3.7219969540931473`*^9}, 3.7219971629786*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["3", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"]}]], "-", 
   FractionBox["d", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.721996915261959*^9, 3.721996956275054*^9}, 
   3.7219971864752283`*^9, 3.7220601863237953`*^9, {3.72206040040834*^9, 
   3.722060422113331*^9}, 3.722060503832246*^9, 3.722064810925529*^9, 
   3.7220717999099407`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finally", "Subsubsection",
 CellChangeTimes->{{3.7219969742704897`*^9, 3.7219969909303217`*^9}}],

Cell["For i != j the only additional simpilfication is", "Text",
 CellChangeTimes->{{3.721997049896892*^9, 3.721997088778614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sgeneral", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GeneralCaseList", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{"a_", ",", 
             RowBox[{
              SubscriptBox["q", "1"], "+", 
              SubscriptBox["q", "2"]}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"sp", "[", 
            RowBox[{"a", ",", "q"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"sp", "[", 
            RowBox[{
             SubscriptBox["q", "1"], ",", 
             SubscriptBox["q", "2"]}], "]"}], "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"q", ",", "q"}], "]"}], "/", "2"}]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1___", ",", "x2_", ",", "x3___"}], "}"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"x2", ",", 
               SubscriptBox["q", "1"]}], "]"}], "===", "False"}], "||", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"x2", ",", 
               SubscriptBox["q", "2"]}], "]"}], "===", "False"}]}], ")"}]}], 
         " ", "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x3", ",", "x2"}], "}"}]}], "}"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"q", ",", "q"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"2", 
       RowBox[{"sp", "[", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], "]"}]}]}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sp", "[", 
       RowBox[{"a_", ",", "q"}], "]"}], ":>", 
      RowBox[{"sp", "[", 
       RowBox[{"a", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7219970969587307`*^9, 3.721997116597576*^9}, 
   3.7219971660230618`*^9, 3.7220605872561207`*^9, {3.7220606556718903`*^9, 
   3.7220606923029957`*^9}, {3.722060779027906*^9, 3.722060787103879*^9}, {
   3.722063943698167*^9, 3.722064009233075*^9}, {3.7220649576686077`*^9, 
   3.72206509310952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrossCheckS", "[", 
  RowBox[{
   RowBox[{"Plus", "@@", "Sgeneral"}], ",", "i", ",", "j"}], "]"}]], "Input",
 CellChangeTimes->{{3.72206803315067*^9, 3.722068077608326*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.722068047951593*^9, 3.7220680779358177`*^9}, 
   3.7220717999431353`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Sij", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sgeneral", "//.", "JoinScalar"}], "//.", "CancelNumerator"}],
        "//.", "PartialFractioning2"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1___", ",", 
           RowBox[{"a_.", "x2_"}], ",", "x3___", ",", 
           RowBox[{"b_.", " ", "x2_"}], ",", "x5___"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"NumericQ", "[", "a", "]"}], "&&", 
          RowBox[{"NumericQ", "[", "b", "]"}]}]}], ":>", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], "x2"}], ",", "x3", ",", "x5"}], 
         "}"}]}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "x1___", ",", "x2_", ",", "x3___", ",", "x4_", ",", "x5___"}], "}"}],
         "/;", 
        RowBox[{"x2", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "x4"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["q", "1"], "\[Rule]", 
               SubscriptBox["q", "2"]}], ",", 
              RowBox[{
               SubscriptBox["q", "2"], "\[Rule]", 
               SubscriptBox["q", "1"]}]}], "}"}]}], "//", "Simplify"}], 
          ")"}]}]}], ":>", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x3", ",", "x5"}], "}"}]}], "}"}]}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1___", ",", "x2_", ",", "x3___", ",", "x4_", ",", "x5___"}],
         "}"}], "/;", 
       RowBox[{"x2", "===", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x4", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "1"], "\[Rule]", 
              SubscriptBox["q", "2"]}], ",", 
             RowBox[{
              SubscriptBox["q", "2"], "\[Rule]", 
              SubscriptBox["q", "1"]}]}], "}"}]}], "//", "Simplify"}], 
         ")"}]}]}], ":>", 
      RowBox[{"{", 
       RowBox[{"x1", ",", 
        RowBox[{"2", "x2"}], ",", "x3", ",", "x5"}], "}"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1___", ",", "x2_", ",", "x3__"}], "}"}], "/;", 
      RowBox[{"FreeQ", "[", 
       RowBox[{"x2", ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], "]"}]}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x1", ",", "x3"}], "}"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.7220608760895567`*^9, 3.7220609415060253`*^9}, {
   3.722061022819715*^9, 3.722061040794916*^9}, {3.722061292161254*^9, 
   3.722061330758099*^9}, {3.7220640251938972`*^9, 3.722064028511628*^9}, {
   3.722064068609337*^9, 3.722064199241315*^9}, {3.72206430517341*^9, 
   3.7220643089122953`*^9}, 3.722065074757514*^9, 3.722065106037552*^9, {
   3.722068128533822*^9, 3.722068132037562*^9}, {3.72206881252666*^9, 
   3.722068860055242*^9}, 3.722073652404191*^9, {3.722074070135194*^9, 
   3.7220741193702497`*^9}, {3.7220771391291637`*^9, 3.722077257591436*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "j"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "j"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "2"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "j"]}], ")"}]}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "j"]}], ")"}], "2"], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["p", "j"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["p", "j"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["p", "j"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "1"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "2"]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "i"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         SubscriptBox["q", "1"]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], ")"}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], ")"}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        SubscriptBox["q", "1"]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "j"]}], ")"}], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "j"], ",", 
        RowBox[{
         SubscriptBox["q", "1"], "+", 
         SubscriptBox["q", "2"]}]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         SubscriptBox["p", "j"]}], ")"}]}], 
      RowBox[{
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "i"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}], " ", 
       RowBox[{"sp", "(", 
        RowBox[{
         SubscriptBox["p", "j"], ",", 
         RowBox[{
          SubscriptBox["q", "1"], "+", 
          SubscriptBox["q", "2"]}]}], ")"}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.722073660936167*^9, 3.7220740433691187`*^9, {3.722074075736775*^9, 
   3.722074091698709*^9}, 3.722074126152728*^9, 3.7220742535134153`*^9, {
   3.722077248684786*^9, 3.7220772670869837`*^9}}],

Cell[BoxData[
 FormBox["14", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.722073660936167*^9, 3.7220740433691187`*^9, {3.722074075736775*^9, 
   3.722074091698709*^9}, 3.722074126152728*^9, 3.7220742535134153`*^9, {
   3.722077248684786*^9, 3.722077267089793*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Plus", "@@", "Sij"}], ")"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Plus", "@@", "Sij"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["q", "1"], "\[Rule]", 
         SubscriptBox["q", "2"]}], ",", 
        RowBox[{
         SubscriptBox["q", "2"], "\[Rule]", 
         SubscriptBox["q", "1"]}]}], "}"}]}], ")"}], "/", "2"}]}], "//", 
  RowBox[{
   RowBox[{"CrossCheckS", "[", 
    RowBox[{"#", ",", "i", ",", "j"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Plus", "@@", "Sij"}], ")"}], "/", "2"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Plus", "@@", "Sij"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["q", "1"], "\[Rule]", 
         SubscriptBox["q", "2"]}], ",", 
        RowBox[{
         SubscriptBox["q", "2"], "\[Rule]", 
         SubscriptBox["q", "1"]}]}], "}"}]}], ")"}], "/", "2"}], "+", 
   RowBox[{"Bubble", "[", 
    RowBox[{"j", ",", "i"}], "]"}], "-", 
   RowBox[{"SPartial", "[", 
    RowBox[{"j", ",", "i"}], "]"}]}], "//", "KinSimplify"}]}], "Input",
 CellChangeTimes->{{3.722068959177249*^9, 3.722069053567759*^9}, {
  3.722071811567881*^9, 3.7220718116522493`*^9}, {3.7220773631356373`*^9, 
  3.722077407003104*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.7220689887824173`*^9, {3.722069054280024*^9, 3.722069074705132*^9}, {
   3.722071801224266*^9, 3.722071812303404*^9}, 3.722074342375659*^9, 
   3.722077277745841*^9, 3.722077407378106*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"d", "-", "6"}], 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], "2"]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.7220689887824173`*^9, {3.722069054280024*^9, 3.722069074705132*^9}, {
   3.722071801224266*^9, 3.722071812303404*^9}, 3.722074342375659*^9, 
   3.722077277745841*^9, 3.722077407534156*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sii", "=", 
  RowBox[{"List", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{"Sgeneral", "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["p", "j"], "\[Rule]", 
            SubscriptBox["p", "i"]}], "}"}]}], ")"}]}], "//", "KinSimplify"}],
       "//", "FullSimplify"}], "//", "Expand"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7220652162873487`*^9, 3.722065255956832*^9}, {
  3.722067668911721*^9, 3.722067671775353*^9}, {3.722067906405425*^9, 
  3.7220679457406387`*^9}, {3.722067986421764*^9, 3.722067988412322*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["p", "i"]}], ")"}], "2"], 
     RowBox[{
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sp", "(", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           SubscriptBox["q", "1"]}], ")"}], "+", 
         RowBox[{"sp", "(", 
          RowBox[{
           SubscriptBox["p", "i"], ",", 
           SubscriptBox["q", "2"]}], ")"}]}], ")"}], "2"]}]], ",", 
    FractionBox[
     RowBox[{"sp", "(", 
      RowBox[{
       SubscriptBox["p", "i"], ",", 
       SubscriptBox["p", "i"]}], ")"}], 
     RowBox[{"2", " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["q", "1"], ",", 
        SubscriptBox["q", "2"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "1"]}], ")"}], " ", 
      RowBox[{"sp", "(", 
       RowBox[{
        SubscriptBox["p", "i"], ",", 
        SubscriptBox["q", "2"]}], ")"}]}]]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.722065240128734*^9, 3.722065257657583*^9}, 
   3.72206767224973*^9, 3.722067947052554*^9, 3.7220680058287497`*^9, 
   3.722071801360083*^9, 3.722077279524925*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["PartialFractioning2"], "Input",
 CellChangeTimes->{{3.722071834548809*^9, 3.722071837328697*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1___", ",", 
      FractionBox[
       RowBox[{"f_", " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "t_"], ",", 
          SubscriptBox["q", "s_"]}], ")"}]}], 
       RowBox[{"g_", " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "t_"], ",", 
          SubscriptBox["q", "r_"]}], ")"}], " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "t_"], ",", 
          RowBox[{
           SubscriptBox["q", "r_"], "+", 
           SubscriptBox["q", "s_"]}]}], ")"}]}]], ",", "x2___"}], "}"}], 
    "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"x1", ",", 
      FractionBox["f", 
       RowBox[{"g", " ", 
        RowBox[{"sp", "(", 
         RowBox[{
          SubscriptBox["p", "t"], ",", 
          SubscriptBox["q", "r"]}], ")"}]}]], ",", 
      RowBox[{"-", 
       FractionBox["f", 
        RowBox[{"g", " ", 
         RowBox[{"sp", "(", 
          RowBox[{
           SubscriptBox["p", "t"], ",", 
           RowBox[{
            SubscriptBox["q", "r"], "+", 
            SubscriptBox["q", "s"]}]}], ")"}]}]]}], ",", "x2"}], "}"}]}], 
   "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.7220718379423227`*^9, 3.722077285726128*^9}]
}, Open  ]],

Cell[BoxData["Sij"], "Input",
 CellChangeTimes->{{3.722077347392593*^9, 3.7220773522753563`*^9}}]
}, Open  ]]
}, Closed]]
},
WindowSize->{1368, 1032},
WindowMargins->{{52, Automatic}, {Automatic, -10}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 136, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[719, 27, 158, 2, 45, "Subsection"],
Cell[880, 31, 736, 23, 59, "Text"],
Cell[CellGroupData[{
Cell[1641, 58, 138, 1, 35, "Subsubsection"],
Cell[1782, 61, 68, 2, 28, "Input"],
Cell[1853, 65, 6159, 109, 403, "Input"],
Cell[8015, 176, 22850, 546, 1780, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30902, 727, 96, 1, 29, "Subsubsection"],
Cell[31001, 730, 1983, 54, 275, "Input"],
Cell[CellGroupData[{
Cell[33009, 788, 497, 14, 55, "Input"],
Cell[33509, 804, 1373, 23, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34919, 832, 2540, 67, 209, "Input"],
Cell[37462, 901, 2096, 33, 34, "Output"]
}, Open  ]],
Cell[39573, 937, 799, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[40397, 952, 620, 15, 55, "Input"],
Cell[41020, 969, 1458, 25, 58, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[42539, 1001, 127, 1, 37, "Subsection"],
Cell[42669, 1004, 303, 6, 33, "Text"],
Cell[42975, 1012, 166, 3, 32, "Input"],
Cell[43144, 1017, 190, 3, 33, "Text"],
Cell[43337, 1022, 6455, 203, 239, "Input"],
Cell[49795, 1227, 89, 1, 33, "Text"],
Cell[49887, 1230, 3351, 111, 123, "Input"],
Cell[CellGroupData[{
Cell[53263, 1345, 527, 17, 32, "Input"],
Cell[53793, 1364, 3605, 112, 87, "Output"]
}, Open  ]],
Cell[57413, 1479, 90, 1, 33, "Text"],
Cell[57506, 1482, 811, 24, 34, "Input"],
Cell[58320, 1508, 125, 1, 33, "Text"],
Cell[58448, 1511, 816, 25, 32, "Input"],
Cell[CellGroupData[{
Cell[59289, 1540, 374, 8, 55, "Input"],
Cell[59666, 1550, 410, 6, 31, "Output"],
Cell[60079, 1558, 408, 6, 31, "Output"]
}, Open  ]],
Cell[60502, 1567, 94, 1, 32, "Input"],
Cell[60599, 1570, 1584, 52, 125, "Text"],
Cell[62186, 1624, 1029, 27, 32, "Input"],
Cell[63218, 1653, 84, 1, 33, "Text"],
Cell[63305, 1656, 176, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[63506, 1662, 2369, 70, 122, "Input"],
Cell[65878, 1734, 824, 12, 31, "Output"],
Cell[66705, 1748, 822, 12, 31, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[67576, 1766, 262, 5, 37, "Subsection"],
Cell[67841, 1773, 663, 11, 63, "Input"],
Cell[CellGroupData[{
Cell[68529, 1788, 115, 1, 35, "Subsubsection"],
Cell[68647, 1791, 780, 22, 52, "Text"],
Cell[69430, 1815, 2324, 65, 76, "Input"],
Cell[71757, 1882, 206, 4, 30, "Text"],
Cell[71966, 1888, 881, 26, 51, "Input"],
Cell[72850, 1916, 120, 1, 30, "Text"],
Cell[72973, 1919, 3222, 81, 238, "Input"],
Cell[76198, 2002, 174, 2, 30, "Text"],
Cell[76375, 2006, 1370, 42, 93, "Input"],
Cell[77748, 2050, 126, 1, 30, "Text"],
Cell[77877, 2053, 2138, 53, 182, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80052, 2111, 126, 1, 35, "Subsubsection"],
Cell[80181, 2114, 355, 6, 49, "Text"],
Cell[80539, 2122, 186, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[80750, 2128, 1900, 53, 80, "Input"],
Cell[82653, 2183, 6988, 173, 70, "Output"]
}, Open  ]],
Cell[89656, 2359, 178, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[89859, 2365, 761, 21, 46, "Input"],
Cell[90623, 2388, 4497, 102, 70, "Output"]
}, Open  ]],
Cell[95135, 2493, 242, 3, 30, "Text"],
Cell[95380, 2498, 955, 27, 51, "Input"],
Cell[96338, 2527, 2358, 62, 81, "Input"],
Cell[98699, 2591, 230, 3, 30, "Text"],
Cell[98932, 2596, 409, 9, 28, "Input"],
Cell[99344, 2607, 172, 4, 30, "Text"],
Cell[99519, 2613, 417, 7, 28, "Input"],
Cell[99939, 2622, 123, 1, 30, "Text"],
Cell[100065, 2625, 1109, 28, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101211, 2658, 110, 1, 35, "Subsubsection"],
Cell[101324, 2661, 282, 9, 32, "Text"],
Cell[101609, 2672, 3052, 68, 131, "Input"],
Cell[CellGroupData[{
Cell[104686, 2744, 213, 4, 46, "Input"],
Cell[104902, 2750, 401, 6, 70, "Output"],
Cell[105306, 2758, 3685, 112, 70, "Output"]
}, Open  ]],
Cell[109006, 2873, 366, 5, 30, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[109421, 2884, 270, 3, 37, "Subsection"],
Cell[CellGroupData[{
Cell[109716, 2891, 109, 1, 35, "Subsubsection"],
Cell[109828, 2894, 307, 10, 32, "Text"],
Cell[110138, 2906, 936, 24, 28, "Input"],
Cell[111077, 2932, 207, 4, 30, "Text"],
Cell[111287, 2938, 4586, 135, 253, "Input"],
Cell[CellGroupData[{
Cell[115898, 3077, 1929, 55, 136, "Input"],
Cell[117830, 3134, 683, 10, 70, "Output"],
Cell[118516, 3146, 683, 10, 70, "Output"],
Cell[119202, 3158, 683, 10, 70, "Output"],
Cell[119888, 3170, 683, 10, 70, "Output"],
Cell[120574, 3182, 683, 10, 70, "Output"],
Cell[121260, 3194, 683, 10, 70, "Output"]
}, Open  ]],
Cell[121958, 3207, 317, 7, 87, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[122312, 3219, 182, 2, 29, "Subsubsection"],
Cell[122497, 3223, 260, 7, 32, "Text"],
Cell[122760, 3232, 287, 6, 30, "Text"],
Cell[123050, 3240, 1927, 50, 51, "Input"],
Cell[CellGroupData[{
Cell[125002, 3294, 352, 7, 28, "Input"],
Cell[125357, 3303, 893, 14, 70, "Output"]
}, Open  ]],
Cell[126265, 3320, 197, 4, 30, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[126499, 3329, 329, 4, 29, "Subsubsection"],
Cell[126831, 3335, 210, 3, 30, "Text"],
Cell[127044, 3340, 3417, 89, 78, "Input"],
Cell[CellGroupData[{
Cell[130486, 3433, 149, 3, 28, "Input"],
Cell[130638, 3438, 2373, 71, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133048, 3514, 498, 13, 28, "Input"],
Cell[133549, 3529, 3765, 119, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[137363, 3654, 364, 6, 29, "Subsubsection"],
Cell[137730, 3662, 116, 1, 30, "Text"],
Cell[137849, 3665, 1858, 52, 73, "Input"],
Cell[139710, 3719, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[139843, 3724, 361, 10, 28, "Input"],
Cell[140207, 3736, 708, 11, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[140964, 3753, 394, 6, 29, "Subsubsection"],
Cell[141361, 3761, 164, 3, 30, "Text"],
Cell[141528, 3766, 113, 1, 30, "Text"],
Cell[141644, 3769, 344, 10, 35, "Input"],
Cell[CellGroupData[{
Cell[142013, 3783, 923, 20, 86, "Input"],
Cell[142939, 3805, 609, 9, 70, "Output"],
Cell[143551, 3816, 609, 9, 70, "Output"],
Cell[144163, 3827, 609, 9, 70, "Output"]
}, Open  ]],
Cell[144787, 3839, 375, 10, 32, "Text"],
Cell[CellGroupData[{
Cell[145187, 3853, 198, 4, 28, "Input"],
Cell[145388, 3859, 404, 6, 70, "Output"]
}, Open  ]],
Cell[145807, 3868, 292, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[146124, 3878, 2222, 64, 105, "Input"],
Cell[148349, 3944, 886, 13, 70, "Output"]
}, Open  ]],
Cell[149250, 3960, 391, 7, 30, "Text"],
Cell[149644, 3969, 1807, 48, 46, "Input"],
Cell[CellGroupData[{
Cell[151476, 4021, 481, 9, 46, "Input"],
Cell[151960, 4032, 526, 8, 70, "Output"],
Cell[152489, 4042, 526, 8, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[153064, 4056, 170, 2, 29, "Subsubsection"],
Cell[153237, 4060, 581, 17, 32, "Input"],
Cell[153821, 4079, 216, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[154062, 4087, 1230, 37, 59, "Input"],
Cell[155295, 4126, 1531, 37, 70, "Output"],
Cell[156829, 4165, 1530, 37, 70, "Output"]
}, Open  ]],
Cell[158374, 4205, 183, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[158582, 4211, 1518, 34, 99, "Input"],
Cell[160103, 4247, 543, 8, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160683, 4260, 1586, 44, 67, "Input"],
Cell[162272, 4306, 1622, 45, 70, "Output"]
}, Open  ]],
Cell[163909, 4354, 1663, 41, 82, "Input"],
Cell[CellGroupData[{
Cell[165597, 4399, 374, 10, 55, "Input"],
Cell[165974, 4411, 457, 7, 70, "Output"],
Cell[166434, 4420, 457, 7, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166928, 4432, 247, 6, 32, "Input"],
Cell[167178, 4440, 478, 7, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167693, 4452, 993, 26, 77, "Input"],
Cell[168689, 4480, 410, 6, 70, "Output"],
Cell[169102, 4488, 412, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169551, 4499, 1512, 42, 145, "Input"],
Cell[171066, 4543, 598, 9, 70, "Output"],
Cell[171667, 4554, 596, 9, 70, "Output"],
Cell[172266, 4565, 596, 9, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172899, 4579, 4965, 150, 155, "Input"],
Cell[177867, 4731, 7549, 252, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185453, 4988, 4938, 149, 156, "Input"],
Cell[190394, 5139, 7547, 252, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197978, 5396, 5782, 169, 200, "Input"],
Cell[203763, 5567, 4505, 148, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208305, 5720, 563, 13, 55, "Input"],
Cell[208871, 5735, 386, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209294, 5746, 371, 10, 32, "Input"],
Cell[209668, 5758, 316, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210021, 5768, 881, 25, 55, "Input"],
Cell[210905, 5795, 387, 6, 70, "Output"]
}, Open  ]],
Cell[211307, 5804, 100, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[211432, 5809, 516, 16, 32, "Input"],
Cell[211951, 5827, 338, 5, 70, "Output"]
}, Open  ]],
Cell[212304, 5835, 115, 1, 33, "Text"],
Cell[212422, 5838, 699, 19, 32, "Input"],
Cell[213124, 5859, 313, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[213462, 5867, 159, 3, 32, "Input"],
Cell[213624, 5872, 290, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213951, 5882, 2728, 73, 122, "Input"],
Cell[216682, 5957, 556, 8, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217275, 5970, 2237, 64, 143, "Input"],
Cell[219515, 6036, 2373, 72, 70, "Output"],
Cell[221891, 6110, 561, 9, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222489, 6124, 2904, 78, 144, "Input"],
Cell[225396, 6204, 4731, 144, 70, "Output"],
Cell[230130, 6350, 733, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230900, 6366, 431, 11, 32, "Input"],
Cell[231334, 6379, 281, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231652, 6389, 561, 16, 32, "Input"],
Cell[232216, 6407, 310, 5, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[232575, 6418, 118, 1, 29, "Subsubsection"],
Cell[232696, 6421, 1635, 46, 78, "Input"],
Cell[234334, 6469, 1617, 44, 165, "Input"],
Cell[235954, 6515, 897, 24, 99, "Input"],
Cell[236854, 6541, 747, 19, 99, "Input"],
Cell[CellGroupData[{
Cell[237626, 6564, 209, 3, 32, "Input"],
Cell[237838, 6569, 554, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238429, 6582, 43, 0, 32, "Input"],
Cell[238475, 6584, 11473, 372, 347, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249985, 6961, 34, 0, 32, "Input"],
Cell[250022, 6963, 543, 14, 33, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[250626, 6984, 467, 11, 41, "Subsection"],
Cell[CellGroupData[{
Cell[251118, 6999, 328, 6, 35, "Subsubsection"],
Cell[251449, 7007, 116, 1, 33, "Text"],
Cell[251568, 7010, 2688, 66, 82, "Input"],
Cell[254259, 7078, 1831, 50, 82, "Input"],
Cell[256093, 7130, 888, 30, 36, "Text"],
Cell[CellGroupData[{
Cell[257006, 7164, 396, 10, 32, "Input"],
Cell[257405, 7176, 1843, 55, 85, "Output"]
}, Open  ]],
Cell[259263, 7234, 219, 4, 33, "Text"],
Cell[259485, 7240, 500, 13, 32, "Input"],
Cell[259988, 7255, 1891, 59, 81, "Input"],
Cell[CellGroupData[{
Cell[261904, 7318, 477, 13, 32, "Input"],
Cell[262384, 7333, 389, 6, 31, "Output"]
}, Open  ]],
Cell[262788, 7342, 626, 20, 35, "Input"],
Cell[263417, 7364, 4131, 120, 157, "Input"],
Cell[267551, 7486, 711, 21, 32, "Input"],
Cell[268265, 7509, 2703, 73, 80, "Input"],
Cell[CellGroupData[{
Cell[270993, 7586, 716, 19, 32, "Input"],
Cell[271712, 7607, 725, 22, 64, "Output"]
}, Open  ]],
Cell[272452, 7632, 552, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[273029, 7649, 431, 11, 32, "Input"],
Cell[273463, 7662, 703, 21, 64, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[274215, 7689, 102, 1, 35, "Subsubsection"],
Cell[274320, 7692, 130, 1, 33, "Text"],
Cell[274453, 7695, 2327, 65, 99, "Input"],
Cell[CellGroupData[{
Cell[276805, 7764, 197, 4, 32, "Input"],
Cell[277005, 7770, 152, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277194, 7778, 3348, 92, 165, "Input"],
Cell[280545, 7872, 11748, 386, 319, "Output"],
Cell[292296, 8260, 272, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[292605, 8270, 1425, 45, 55, "Input"],
Cell[294033, 8317, 269, 5, 31, "Output"],
Cell[294305, 8324, 506, 15, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294848, 8344, 662, 17, 34, "Input"],
Cell[295513, 8363, 1604, 51, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297154, 8419, 111, 1, 32, "Input"],
Cell[297268, 8422, 1320, 42, 67, "Output"]
}, Open  ]],
Cell[298603, 8467, 97, 1, 32, "Input"]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
